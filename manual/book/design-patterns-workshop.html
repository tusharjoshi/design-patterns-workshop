<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.23">
<meta name="author" content="Tushar Joshi">
<title>Design Patterns Workshop</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.square{list-style-type:square}
ul.circle ul:not([class]),ul.disc ul:not([class]),ul.square ul:not([class]){list-style:inherit}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child{border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:first-child,.sidebarblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child,.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active,#footnotes .footnote a:first-of-type:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,td.hdlist1,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
pre.rouge table td { padding: 5px; }
pre.rouge table pre { margin: 0; }
pre.rouge, pre.rouge .w {
  color: #24292f;
  background-color: #f6f8fa;
}
pre.rouge .k, pre.rouge .kd, pre.rouge .kn, pre.rouge .kp, pre.rouge .kr, pre.rouge .kt, pre.rouge .kv {
  color: #cf222e;
}
pre.rouge .gr {
  color: #f6f8fa;
}
pre.rouge .gd {
  color: #82071e;
  background-color: #ffebe9;
}
pre.rouge .nb {
  color: #953800;
}
pre.rouge .nc {
  color: #953800;
}
pre.rouge .no {
  color: #953800;
}
pre.rouge .nn {
  color: #953800;
}
pre.rouge .sr {
  color: #116329;
}
pre.rouge .na {
  color: #116329;
}
pre.rouge .nt {
  color: #116329;
}
pre.rouge .gi {
  color: #116329;
  background-color: #dafbe1;
}
pre.rouge .ges {
  font-weight: bold;
  font-style: italic;
}
pre.rouge .kc {
  color: #0550ae;
}
pre.rouge .l, pre.rouge .ld, pre.rouge .m, pre.rouge .mb, pre.rouge .mf, pre.rouge .mh, pre.rouge .mi, pre.rouge .il, pre.rouge .mo, pre.rouge .mx {
  color: #0550ae;
}
pre.rouge .sb {
  color: #0550ae;
}
pre.rouge .bp {
  color: #0550ae;
}
pre.rouge .ne {
  color: #0550ae;
}
pre.rouge .nl {
  color: #0550ae;
}
pre.rouge .py {
  color: #0550ae;
}
pre.rouge .nv, pre.rouge .vc, pre.rouge .vg, pre.rouge .vi, pre.rouge .vm {
  color: #0550ae;
}
pre.rouge .o, pre.rouge .ow {
  color: #0550ae;
}
pre.rouge .gh {
  color: #0550ae;
  font-weight: bold;
}
pre.rouge .gu {
  color: #0550ae;
  font-weight: bold;
}
pre.rouge .s, pre.rouge .sa, pre.rouge .sc, pre.rouge .dl, pre.rouge .sd, pre.rouge .s2, pre.rouge .se, pre.rouge .sh, pre.rouge .sx, pre.rouge .s1, pre.rouge .ss {
  color: #0a3069;
}
pre.rouge .nd {
  color: #8250df;
}
pre.rouge .nf, pre.rouge .fm {
  color: #8250df;
}
pre.rouge .err {
  color: #f6f8fa;
  background-color: #82071e;
}
pre.rouge .c, pre.rouge .ch, pre.rouge .cd, pre.rouge .cm, pre.rouge .cp, pre.rouge .cpf, pre.rouge .c1, pre.rouge .cs {
  color: #6e7781;
}
pre.rouge .gl {
  color: #6e7781;
}
pre.rouge .gt {
  color: #6e7781;
}
pre.rouge .ni {
  color: #24292f;
}
pre.rouge .si {
  color: #24292f;
}
pre.rouge .ge {
  color: #24292f;
  font-style: italic;
}
pre.rouge .gs {
  color: #24292f;
  font-weight: bold;
}
</style>
</head>
<body class="book">
<div id="header">
<h1>Design Patterns Workshop</h1>
<div class="details">
<span id="author" class="author">Tushar Joshi</span><br>
<span id="email" class="email"><a href="mailto:tusharvjoshi@gmail.com">tusharvjoshi@gmail.com</a></span><br>
</div>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_licence">Licence</a></li>
<li><a href="#_preface">Preface</a>
<ul class="sectlevel2">
<li><a href="#_what_is_this_manual_about">What is this manual about?</a></li>
<li><a href="#_major_goal_of_this_manual">Major Goal of this manual</a></li>
</ul>
</li>
<li><a href="#_dedication">Dedication</a></li>
<li><a href="#_introduction">Introduction</a>
<ul class="sectlevel2">
<li><a href="#_patterns">Patterns</a></li>
</ul>
</li>
<li><a href="#ch01-solid-principles">SOLID Principles</a>
<ul class="sectlevel2">
<li><a href="#_single_responsibility_principle">Single Responsibility Principle</a></li>
<li><a href="#_open_close_principle">Open Close Principle</a></li>
<li><a href="#_liskov_substitution_principle">Liskov Substitution Principle</a></li>
<li><a href="#_interface_segregation_principle">Interface Segregation Principle</a></li>
<li><a href="#_dependency_inversion_principle">Dependency Inversion Principle</a></li>
<li><a href="#_summary">Summary</a></li>
</ul>
</li>
<li><a href="#ch02-singleton">Singleton Pattern</a>
<ul class="sectlevel2">
<li><a href="#_gof_definition">GoF Definition</a></li>
<li><a href="#_uml_representation_6">UML Representation</a></li>
<li><a href="#_eager_initialization">Eager Initialization</a></li>
<li><a href="#_lazy_loading_with_thread_safety">Lazy Loading with thread safety</a></li>
<li><a href="#_lazy_loading_with_double_checked_locking">Lazy Loading with Double Checked Locking</a></li>
<li><a href="#_bill_pughs_static_helper">Bill Pugh&#8217;s Static Helper</a></li>
<li><a href="#_interface_based_implementation">Interface Based Implementation</a></li>
<li><a href="#_spring_boot_version">Spring Boot Version</a></li>
<li><a href="#_singleton_and_enum_by_joshua_bloch">Singleton and Enum by Joshua Bloch</a></li>
<li><a href="#_singleton_and_reflection">Singleton and reflection</a></li>
<li><a href="#_singleton_and_serialization">Singleton and serialization</a></li>
<li><a href="#_singleton_instances_in_jdk">Singleton Instances in JDK</a></li>
<li><a href="#_singleton_example_in_go">Singleton example in Go</a></li>
</ul>
</li>
<li><a href="#ch03-factory">Factory Pattern</a>
<ul class="sectlevel2">
<li><a href="#_gof_definition_2">GoF Definition</a></li>
<li><a href="#_things_to_note_about_factory_pattern">Things to note about Factory Pattern</a></li>
<li><a href="#_uml_interpretation">UML Interpretation</a></li>
<li><a href="#_basic_factory">Basic Factory</a></li>
<li><a href="#_loose_coupling">Loose Coupling</a></li>
<li><a href="#_encapsulation_using_factory">Encapsulation using Factory</a></li>
<li><a href="#_factory_instances_in_jdk">Factory instances in JDK</a></li>
</ul>
</li>
<li><a href="#ch04-abstract-factory">Abstract Factory Pattern</a>
<ul class="sectlevel2">
<li><a href="#_gof_definition_3">GoF Definition</a></li>
<li><a href="#_block_diagram">Block Diagram</a></li>
<li><a href="#_uml_representation_7">UML Representation</a></li>
<li><a href="#_ui_tools_example">UI Tools Example</a></li>
<li><a href="#_separated_interface_1">Separated Interface.<sup class="footnote">[1]</sup></a></li>
<li><a href="#_abstract_factory_instances_in_jdk">Abstract Factory instances in JDK</a></li>
</ul>
</li>
<li><a href="#ch05-builder">Builder Pattern</a>
<ul class="sectlevel2">
<li><a href="#_gof_definition_4">GoF Definition</a></li>
<li><a href="#_uml_interpretation_2">UML Interpretation</a></li>
<li><a href="#_resume_builder_example">Resume Builder Example</a></li>
<li><a href="#_builder_instances_in_jdk">Builder instances in JDK</a></li>
</ul>
</li>
<li><a href="#ch06-prototype">Prototype Pattern</a>
<ul class="sectlevel2">
<li><a href="#_gof_definition_5">GoF Definition</a></li>
<li><a href="#_uml_representation_8">UML Representation</a></li>
<li><a href="#_vocabulary_store_example">Vocabulary Store Example</a></li>
<li><a href="#_prototype_instances_in_jdk">Prototype instances in JDK</a></li>
</ul>
</li>
<li><a href="#ch07-adapter">Adapter Pattern</a>
<ul class="sectlevel2">
<li><a href="#_gof_definition_6">GoF Definition</a></li>
<li><a href="#_basic_components_2">Basic Components</a></li>
<li><a href="#_uml_representation_9">UML Representation</a></li>
<li><a href="#_adapter_instances_in_jdk">Adapter instances in JDK</a></li>
</ul>
</li>
<li><a href="#ch08-bridge">Bridge Pattern</a>
<ul class="sectlevel2">
<li><a href="#_gof_definition_7">GoF Definition</a></li>
<li><a href="#_basic_concept">Basic Concept</a></li>
<li><a href="#_components">Components</a></li>
<li><a href="#_inheritance_example">Inheritance Example</a></li>
<li><a href="#_bridge_example">Bridge Example</a></li>
</ul>
</li>
<li><a href="#ch09-proxy">Proxy Pattern</a>
<ul class="sectlevel2">
<li><a href="#_gof_definition_8">GoF Definition</a></li>
<li><a href="#_basic_components_3">Basic Components</a></li>
<li><a href="#_remote_proxies">Remote Proxies</a></li>
<li><a href="#_virtual_proxies">Virtual Proxies</a></li>
<li><a href="#_protection_proxies">Protection Proxies</a></li>
<li><a href="#_proxy_instances_in_jdk">Proxy instances in JDK</a></li>
</ul>
</li>
<li><a href="#ch10-composite">Composite Pattern</a>
<ul class="sectlevel2">
<li><a href="#_gof_definition_9">GoF Definition</a></li>
<li><a href="#_basic_components_4">Basic Components</a></li>
<li><a href="#_uml_representation_10">UML Representation</a></li>
<li><a href="#_proxy_instances_in_jdk_2">Proxy instances in JDK</a></li>
</ul>
</li>
<li><a href="#ch11-decorator">Decorator Pattern</a>
<ul class="sectlevel2">
<li><a href="#_gof_definition_10">GoF Definition</a></li>
<li><a href="#_basic_components_5">Basic Components</a></li>
<li><a href="#_uml_representation_11">UML Representation</a></li>
<li><a href="#_convenience_wrappers">Convenience Wrappers</a></li>
<li><a href="#_anti_corruption_layer">Anti Corruption Layer</a></li>
<li><a href="#_uml_representation_12">UML Representation</a></li>
<li><a href="#_decorator_instances_in_jdk">Decorator instances in JDK</a></li>
</ul>
</li>
<li><a href="#ch12-facade">Facade Pattern</a>
<ul class="sectlevel2">
<li><a href="#_gof_definition_11">GoF Definition</a></li>
<li><a href="#_basic_components_6">Basic Components</a></li>
<li><a href="#_uml_representation_13">UML Representation</a></li>
</ul>
</li>
<li><a href="#ch13-flyweight">Flyweight Pattern</a>
<ul class="sectlevel2">
<li><a href="#_gof_definition_12">GoF Definition</a></li>
<li><a href="#_basic_components_7">Basic Components</a></li>
<li><a href="#_uml_representation_14">UML Representation</a></li>
<li><a href="#_references_in_jdk">References in JDK</a></li>
</ul>
</li>
<li><a href="#ch14-memento">Memento Pattern</a>
<ul class="sectlevel2">
<li><a href="#_gof_definition_13">GoF Definition</a></li>
<li><a href="#_basic_components_8">Basic Components</a></li>
<li><a href="#_uml_representation_15">UML Representation</a></li>
</ul>
</li>
<li><a href="#ch15-iterator">Iterator Pattern</a>
<ul class="sectlevel2">
<li><a href="#_gof_definition_14">GoF Definition</a></li>
<li><a href="#_basic_components_9">Basic Components</a></li>
<li><a href="#_uml_representation_16">UML Representation</a></li>
</ul>
</li>
<li><a href="#ch16-observer">Observer Pattern</a>
<ul class="sectlevel2">
<li><a href="#_gof_definition_15">GoF Definition</a></li>
<li><a href="#_basic_components_10">Basic Components</a></li>
</ul>
</li>
<li><a href="#ch17-interpreter">Interpreter Pattern</a>
<ul class="sectlevel2">
<li><a href="#_gof_definition_16">GoF Definition</a></li>
<li><a href="#_basic_components_11">Basic Components</a></li>
<li><a href="#_custom_dsl_and_evaluation">Custom DSL and Evaluation</a></li>
</ul>
</li>
<li><a href="#ch18-mediator">Mediator Pattern</a>
<ul class="sectlevel2">
<li><a href="#_gof_definition_17">GoF Definition</a></li>
</ul>
</li>
<li><a href="#ch19-command">Command Pattern</a>
<ul class="sectlevel2">
<li><a href="#_gof_definition_18">GoF Definition</a></li>
</ul>
</li>
<li><a href="#ch20-chain">Chain of Responsibility Pattern</a>
<ul class="sectlevel2">
<li><a href="#_gof_definition_19">GoF Definition</a></li>
</ul>
</li>
<li><a href="#ch21-state">State Pattern</a>
<ul class="sectlevel2">
<li><a href="#_gof_definition_20">GoF Definition</a></li>
</ul>
</li>
<li><a href="#ch22-strategy">Strategy Pattern</a>
<ul class="sectlevel2">
<li><a href="#_gof_definition_21">GoF Definition</a></li>
</ul>
</li>
<li><a href="#ch17-template">Template Method Pattern</a>
<ul class="sectlevel2">
<li><a href="#_gof_definition_22">GoF Definition</a></li>
</ul>
</li>
<li><a href="#ch24-visitor">Visitor Pattern</a>
<ul class="sectlevel2">
<li><a href="#_gof_definition_23">GoF Definition</a></li>
</ul>
</li>
<li><a href="#_example_conventions">Example Conventions</a></li>
<li><a href="#_references">References</a></li>
<li><a href="#A-mnemonic">Appendix A: Mnemonic to remember design patterns</a>
<ul class="sectlevel2">
<li><a href="#_popular_mnemonic_from_ajit_mungales_article">Popular Mnemonic from Ajit Mungale&#8217;s article</a></li>
</ul>
</li>
<li><a href="#B-ast">Appendix B: Building Abstract Syntax Tree</a></li>
<li><a href="#C-git-repo">Appendix C: Maintaining multiple GIT repositories</a>
<ul class="sectlevel2">
<li><a href="#_how_this_repository_is_maintained">How this repository is maintained</a></li>
<li><a href="#_creating_repository_copies">Creating repository copies</a></li>
<li><a href="#_configuring_git_for_simultaneous_push">Configuring GIT for simultaneous push</a></li>
</ul>
</li>
<li><a href="#D-manual-info">Appendix D: How this manual is created</a>
<ul class="sectlevel2">
<li><a href="#_how_to_build_the_manual">How to build the manual</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_licence">Licence</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This work is licensed under the Creative Commons Attribution-NonCommercial-ShareAlike 3.0 Unported License.
To view a copy of this license, visit <a href="https://creativecommons.org/licenses/by-nc-sa/3.0" class="bare">https://creativecommons.org/licenses/by-nc-sa/3.0</a> or send a letter to Creative Commons, PO Box 1866, Mountain View, CA 94042, USA.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_preface">Preface</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_what_is_this_manual_about">What is this manual about?</h3>
<div class="paragraph">
<p>This manual is compilation of definition, discussion and examples of 23 Design Patterns mentioned in the GoF Design Patterns book from 1994 by Kent Beck, Eric Gamma, et all.</p>
</div>
<div class="paragraph">
<p>The compilation of this manual started as a supplementary documentation for Design Patterns Workshop.  This is an effort to compile enough available information relevant to the topic so it can be referred as a handy reference.</p>
</div>
<div class="paragraph">
<p>The manual has been updated from the suggestions and discussions which happened in the Design Patterns Workshop conducted at Persistent Systems.</p>
</div>
<div class="paragraph">
<p>The examples referred in this manual are available at <a href="https://github.com/tusharjoshi/design-patterns-workshop">GitHub repository for the Design Patterns Workshop</a> also at <a href="https://gitlab.com/tusharjoshi/design-patterns-workshop">Gitlab</a> and <a href="https://bitbucket.org/tusharvjoshi/design-patterns-workshop">Bitbucket</a></p>
</div>
</div>
<div class="sect2">
<h3 id="_major_goal_of_this_manual">Major Goal of this manual</h3>
<div class="paragraph">
<p>To maintain minimum one example for each design pattern from the initial 23 design patterns.  The examples are designed to be as near to the production code which can be used in projects.  Usage of apple, banana like examples which are created just to explain the design patterns are avoided.</p>
</div>
<div class="paragraph">
<p>Basic examples and many examples are already available all over the internet and the books and articles mentioned in the reference section.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_dedication">Dedication</h2>
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<img src="images/rahul-ekbote-2020.jpg" alt="Rahul Ekbote">
</div>
</div>
<div class="paragraph">
<p>To my mentor <a href="https://www.linkedin.com/in/rahul-ekbote-99b9013">Rahul Ekbote</a>, his vision and support made this work possible.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_introduction">Introduction</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_patterns">Patterns</h3>
<div class="paragraph">
<p>Patterns is a concept introduced by Christopher Alexander,<sup class="footnote">[<a id="_footnoteref_1" class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup> and is widely accepted in the software community to document design constructs which are used to build software systems.
Patterns provide a structured way of looking at a problem space with the solutions which are seen multiple times and proven.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/design-patterns-map.png" alt="design patterns map" width="980" height="696">
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s get started.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ch01-solid-principles">SOLID Principles</h2>
<div class="sectionbody">
<div class="paragraph">
<p>SOLID Principles Introduction</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/solid-mindmap.png" alt="solid mindmap" width="592" height="189">
</div>
</div>
<div class="sect2">
<h3 id="_single_responsibility_principle">Single Responsibility Principle</h3>
<div class="paragraph">
<p>
The single responsibility principle instructs developers to write code that has one and only one reason to change. If a class has more than one reason to change, it has more than one responsibility. Classes with more than a single responsibility should be broken down into smaller classes, each of which should have only one responsibility and reason to change.</p>
</div>
<div class="sect3">
<h4 id="_all_in_one">All In One</h4>
<div class="paragraph">
<p>This example violates the single responsibility principle by doing everything at one place.  Such programs are usually written as POC and temporary code, but the Ball Of Mud pattern prevails many times and program written for temporary purposes ends in real world just because it works and provides certain functionality.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Main</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Scanner</span> <span class="n">in</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Scanner</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="na">in</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="s">"Enter your name: "</span><span class="o">);</span>
        <span class="nc">String</span> <span class="n">name</span> <span class="o">=</span> <span class="n">in</span><span class="o">.</span><span class="na">nextLine</span><span class="o">();</span>
        <span class="n">in</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>

        <span class="nc">String</span> <span class="n">greeting</span> <span class="o">=</span> <span class="s">"Hello "</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s">" Greetings and Welcome!"</span><span class="o">;</span>

        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">greeting</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_modular_design_with_single_responsibility">Modular Design with Single Responsibility</h4>
<div class="paragraph">
<p>Separating the responsibilities into multiple components not only abides by single responsibility principle, it also makes the code unit smaller, easy to read and maintainable.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Greeter</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">NameProvider</span> <span class="n">nameProvider</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">MessageDisplayer</span> <span class="n">displayer</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Greeter</span><span class="o">(</span><span class="nc">NameProvider</span> <span class="n">nameProvider</span><span class="o">,</span> <span class="nc">MessageDisplayer</span> <span class="n">displayer</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">nameProvider</span> <span class="o">=</span> <span class="n">nameProvider</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">displayer</span> <span class="o">=</span> <span class="n">displayer</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">greet</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">String</span> <span class="n">greeting</span> <span class="o">=</span> <span class="s">"Hello "</span>
            <span class="o">+</span> <span class="n">nameProvider</span><span class="o">.</span><span class="na">getName</span><span class="o">()</span>
            <span class="o">+</span> <span class="s">" Greetings and Welcome!"</span><span class="o">;</span>
        <span class="n">displayer</span><span class="o">.</span><span class="na">display</span><span class="o">(</span><span class="n">greeting</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">NameProvider</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getName</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">Scanner</span> <span class="n">in</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Scanner</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="na">in</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="s">"Enter your name: "</span><span class="o">);</span>
        <span class="nc">String</span> <span class="n">name</span> <span class="o">=</span> <span class="n">in</span><span class="o">.</span><span class="na">nextLine</span><span class="o">();</span>
        <span class="n">in</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
        <span class="k">return</span> <span class="n">name</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MessageDisplayer</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">display</span><span class="o">(</span><span class="nc">String</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="n">message</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Main</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">NameProvider</span> <span class="n">nameProvider</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">NameProvider</span><span class="o">();</span>
        <span class="nc">MessageDisplayer</span> <span class="n">displayer</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">MessageDisplayer</span><span class="o">();</span>
        <span class="nc">Greeter</span> <span class="n">greeter</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Greeter</span><span class="o">(</span><span class="n">nameProvider</span><span class="o">,</span> <span class="n">displayer</span><span class="o">);</span>
        <span class="n">greeter</span><span class="o">.</span><span class="na">greet</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">GreeterTest</span> <span class="o">{</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">test_greet</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">MockNameProvider</span> <span class="n">nameProvider</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">MockNameProvider</span><span class="o">();</span>
        <span class="nc">MockDisplayer</span> <span class="n">displayer</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">MockDisplayer</span><span class="o">();</span>
        <span class="nc">Greeter</span> <span class="n">greeter</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Greeter</span><span class="o">(</span><span class="n">nameProvider</span><span class="o">,</span> <span class="n">displayer</span><span class="o">);</span>
        <span class="n">greeter</span><span class="o">.</span><span class="na">greet</span><span class="o">();</span>

        <span class="n">assertEquals</span><span class="o">(</span>
            <span class="s">"Hello MockName Greetings and Welcome!"</span><span class="o">,</span>
            <span class="n">displayer</span><span class="o">.</span><span class="na">getMessage</span><span class="o">()</span>
        <span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kd">class</span> <span class="nc">MockNameProvider</span> <span class="kd">extends</span> <span class="nc">NameProvider</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getName</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="s">"MockName"</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kd">class</span> <span class="nc">MockDisplayer</span> <span class="kd">extends</span> <span class="nc">MessageDisplayer</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="nc">String</span> <span class="n">message</span><span class="o">;</span>

        <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getMessage</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">message</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">display</span><span class="o">(</span><span class="nc">String</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">message</span> <span class="o">=</span> <span class="n">message</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_open_close_principle">Open Close Principle</h3>
<div class="paragraph">
<p></p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<div class="title">Bertrand Mayer definition</div>
<p>From his 1988 book, Object-Oriented Software Construction (Prentice Hall), defined the open/closed principle (OCP) as follows:</p>
</div>
<div class="paragraph">
<p>Software entities should be open for extension, but closed for modification.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<div class="title">Robert C. Martin definition</div>
<p>“Open for extension.” This means that the behavior of the module can be extended. As the requirements of the application change, we are able to extend the module with new behaviors that satisfy those changes. In other words, we are able to change what the module does.</p>
</div>
<div class="paragraph">
<p>“Closed for modification.” Extending the behavior of a module does not result in changes to the source or binary code of the module. The binary executable version of the module, whether in a linkable library, a DLL, or a Java .jar, remains untouched.</p>
</div>
<div class="paragraph">
<p>—Robert C. Martin, Agile Software Development: Principles, Patterns, and Practices (Prentice Hall, 2003)</p>
</div>
</div>
</div>
<div class="paragraph">
<p>Open Close Principle advocates class to be open for extension but closed for modifications.  To enhance the functionality the design should allow additions of new functionality by adding new files to the code, instead of modifying an existing file.</p>
</div>
<div class="sect3">
<h4 id="_switch_unclean_example">Switch Unclean Example</h4>
<div class="paragraph">
<p>
The logic in the example below in <code>DiscountCalculator</code> is based on month number.  For different months we need discount to be calculated with some rules.  For addition of new rules or modification of any existing rule we will have to change the file <code>DiscountCalculator</code> and hence this file violates the open close principle.</p>
</div>
<div class="paragraph">
<p>Just to change one rule if we touch the file <code>DiscountCalculator</code> we will have to regression test all the rules to make sure nothing is broken in other parts which are also in the same file.</p>
</div>
</div>
<div class="sect3">
<h4 id="_uml_representation">UML Representation</h4>
<div class="imageblock">
<div class="content">
<img src="images/switch-unclean.png" alt="switch unclean" width="396" height="185">
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">DiscountCalculator</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kt">double</span> <span class="nf">calculateDiscount</span><span class="o">(</span><span class="kt">double</span> <span class="n">amount</span><span class="o">,</span> <span class="kt">int</span> <span class="n">month</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">double</span> <span class="n">discount</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="k">switch</span><span class="o">(</span><span class="n">month</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">case</span> <span class="mi">1</span><span class="o">:</span>
            <span class="k">case</span> <span class="mi">2</span><span class="o">:</span>
                <span class="n">discount</span> <span class="o">=</span> <span class="n">amount</span> <span class="o">*</span> <span class="mf">0.1</span><span class="o">;</span>
                <span class="k">break</span><span class="o">;</span>
            <span class="k">case</span> <span class="mi">8</span><span class="o">:</span>
                <span class="n">discount</span> <span class="o">=</span> <span class="n">amount</span> <span class="o">*</span> <span class="mf">0.2</span><span class="o">;</span>
                <span class="k">break</span><span class="o">;</span>
            <span class="k">default</span><span class="o">:</span>
                <span class="n">discount</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
                <span class="k">break</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">discount</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">DiscountCalculatorTest</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="nc">DiscountCalculator</span> <span class="n">target</span><span class="o">;</span>

    <span class="nd">@BeforeEach</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">beforeEach</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">target</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">DiscountCalculator</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">verify_janfeb_discount_10</span><span class="o">()</span> <span class="o">{</span>
        <span class="kt">double</span> <span class="n">discount</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="na">calculateDiscount</span><span class="o">(</span><span class="mi">1000</span><span class="o">,</span> <span class="mi">1</span><span class="o">);</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="mi">100</span><span class="o">,</span> <span class="n">discount</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">verify_aug_discount_10</span><span class="o">()</span> <span class="o">{</span>
        <span class="kt">double</span> <span class="n">discount</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="na">calculateDiscount</span><span class="o">(</span><span class="mi">1000</span><span class="o">,</span> <span class="mi">8</span><span class="o">);</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="mi">200</span><span class="o">,</span> <span class="n">discount</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">verify_other_discount_10</span><span class="o">()</span> <span class="o">{</span>
        <span class="kt">double</span> <span class="n">discount</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="na">calculateDiscount</span><span class="o">(</span><span class="mi">1000</span><span class="o">,</span> <span class="mi">6</span><span class="o">);</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">discount</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_switch_clean_version">Switch clean version</h4>
<div class="paragraph">
<p>
In this version we extracted the logic of calculating the discount into separate classes implementing same interface.  The map of all such strategies will maintain what rule we want to use for certain month.</p>
</div>
<div class="paragraph">
<p>If we need to change an existing rule only one existing class needs changes and the rest of the rules need no testing as they were not changed.</p>
</div>
<div class="paragraph">
<p>For addition of new rule we need to add a new class implementation of strategy and add it to the map.  Again retesting of existing rules is not needed, as <code>DiscountCalculator</code> class is now open to extension but closed to modification.</p>
</div>
</div>
<div class="sect3">
<h4 id="_uml_representation_2">UML Representation</h4>
<div class="imageblock">
<div class="content">
<img src="images/switch-clean.png" alt="switch clean" width="683" height="309">
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">DiscountCalculator</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">double</span> <span class="nf">calculateDiscount</span><span class="o">(</span><span class="kt">double</span> <span class="n">amount</span><span class="o">,</span> <span class="kt">int</span> <span class="n">month</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">IDiscountStrategy</span> <span class="n">strategy</span> <span class="o">=</span> <span class="nc">DiscountStrategyMap</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">month</span><span class="o">);</span> <i class="conum" data-value="1"></i><b>(1)</b>
        <span class="k">return</span> <span class="n">strategy</span><span class="o">.</span><span class="na">calculateDiscount</span><span class="o">(</span><span class="n">amount</span><span class="o">,</span> <span class="n">month</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Get strategy object for given month</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">IDiscountStrategy</span> <span class="o">{</span>
    <span class="kt">double</span> <span class="nf">calculateDiscount</span><span class="o">(</span><span class="kt">double</span> <span class="n">amount</span><span class="o">,</span> <span class="kt">int</span> <span class="n">month</span><span class="o">);</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">DiscountStrategyMap</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">,</span> <span class="nc">IDiscountStrategy</span><span class="o">&gt;</span> <span class="n">strategyMap</span> <span class="o">=</span> <span class="n">createStrategies</span><span class="o">();</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">,</span> <span class="nc">IDiscountStrategy</span><span class="o">&gt;</span> <span class="nf">createStrategies</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">,</span> <span class="nc">IDiscountStrategy</span><span class="o">&gt;</span> <span class="n">map</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;&gt;();</span>
        <span class="nc">IDiscountStrategy</span> <span class="n">janFebStrategy</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">JanFebDiscountStrategy</span><span class="o">();</span>
        <span class="nc">IDiscountStrategy</span> <span class="n">augStrategy</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">AugDiscountStrategy</span><span class="o">();</span>
        <span class="nc">IDiscountStrategy</span> <span class="n">otherStrategy</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">OtherDiscountStrategy</span><span class="o">();</span>
        <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">janFebStrategy</span><span class="o">);</span>
        <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="n">janFebStrategy</span><span class="o">);</span>
        <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="n">otherStrategy</span><span class="o">);</span>
        <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="mi">4</span><span class="o">,</span> <span class="n">otherStrategy</span><span class="o">);</span>
        <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="mi">5</span><span class="o">,</span> <span class="n">otherStrategy</span><span class="o">);</span>
        <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="mi">6</span><span class="o">,</span> <span class="n">otherStrategy</span><span class="o">);</span>
        <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="mi">7</span><span class="o">,</span> <span class="n">otherStrategy</span><span class="o">);</span>
        <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="mi">8</span><span class="o">,</span> <span class="n">augStrategy</span><span class="o">);</span>
        <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="mi">9</span><span class="o">,</span> <span class="n">otherStrategy</span><span class="o">);</span>
        <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="mi">10</span><span class="o">,</span> <span class="n">otherStrategy</span><span class="o">);</span>
        <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="mi">11</span><span class="o">,</span> <span class="n">otherStrategy</span><span class="o">);</span>
        <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="mi">12</span><span class="o">,</span> <span class="n">otherStrategy</span><span class="o">);</span>

        <span class="k">return</span> <span class="n">map</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">IDiscountStrategy</span> <span class="nf">get</span><span class="o">(</span><span class="kt">int</span> <span class="n">month</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">strategyMap</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">month</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">JanFebDiscountStrategy</span> <span class="kd">implements</span> <span class="nc">IDiscountStrategy</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">double</span> <span class="nf">calculateDiscount</span><span class="o">(</span><span class="kt">double</span> <span class="n">amount</span><span class="o">,</span> <span class="kt">int</span> <span class="n">month</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">amount</span> <span class="o">*</span> <span class="mf">0.1</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">AugDiscountStrategy</span> <span class="kd">implements</span> <span class="nc">IDiscountStrategy</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">double</span> <span class="nf">calculateDiscount</span><span class="o">(</span><span class="kt">double</span> <span class="n">amount</span><span class="o">,</span> <span class="kt">int</span> <span class="n">month</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">amount</span> <span class="o">*</span> <span class="mf">0.2</span>
        <span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">OtherDiscountStrategy</span> <span class="kd">implements</span> <span class="nc">IDiscountStrategy</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">double</span> <span class="nf">calculateDiscount</span><span class="o">(</span><span class="kt">double</span> <span class="n">amount</span><span class="o">,</span> <span class="kt">int</span> <span class="n">month</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="mf">0.0</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_liskov_substitution_principle">Liskov Substitution Principle</h3>
<div class="paragraph">
<p>
The component/object must honor the public contract it promises</p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<div class="title">Barbara Liskov Definition</div>
<p>The Liskov Substitution principle was introduced by Barbara Liskov in her conference keynote “Data abstraction” in 1987.</p>
</div>
<div class="paragraph">
<p>If S is a subtype of T, then objects of type T may be replaced with objects of type S, without breaking the program.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_uml_representation_3">UML Representation</h4>
<div class="imageblock">
<div class="content">
<img src="images/liskov-components.png" alt="liskov components" width="202" height="169">
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Rectangle</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">length</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">breadth</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getLength</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">length</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setLength</span><span class="o">(</span><span class="kt">int</span> <span class="n">length</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">length</span> <span class="o">=</span> <span class="n">length</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getBreadth</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">breadth</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setBreadth</span><span class="o">(</span><span class="kt">int</span> <span class="n">breadth</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">breadth</span> <span class="o">=</span> <span class="n">breadth</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getArea</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">length</span> <span class="o">*</span> <span class="n">breadth</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Square</span> <span class="kd">extends</span> <span class="nc">Rectangle</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setLength</span><span class="o">(</span><span class="kt">int</span> <span class="n">length</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">setLength</span><span class="o">(</span><span class="n">length</span><span class="o">);</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">setBreadth</span><span class="o">(</span><span class="n">length</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setBreadth</span><span class="o">(</span><span class="kt">int</span> <span class="n">breadth</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">setLength</span><span class="o">(</span><span class="n">breadth</span><span class="o">);</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">setBreadth</span><span class="o">(</span><span class="n">breadth</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">AreaCalculator</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">int</span> <span class="nf">calculateArea</span><span class="o">(</span><span class="nc">Rectangle</span> <span class="n">rectangle</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">rectangle</span><span class="o">.</span><span class="na">setLength</span><span class="o">(</span><span class="mi">2</span><span class="o">);</span>
        <span class="n">rectangle</span><span class="o">.</span><span class="na">setBreadth</span><span class="o">(</span><span class="mi">3</span><span class="o">);</span>

        <span class="k">return</span> <span class="n">rectangle</span><span class="o">.</span><span class="na">getArea</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">AreaCalculatorTest</span> <span class="o">{</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">test_calculate_area</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">Rectangle</span> <span class="n">rectangle</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Square</span><span class="o">();</span>
        <span class="kt">int</span> <span class="n">area</span> <span class="o">=</span> <span class="nc">AreaCalculator</span><span class="o">.</span><span class="na">calculateArea</span><span class="o">(</span><span class="n">rectangle</span><span class="o">);</span> <span class="c1">// 2 * 3 = 6</span>

        <span class="n">assertEquals</span><span class="o">(</span><span class="mi">9</span><span class="o">,</span> <span class="n">area</span><span class="o">);</span> <span class="c1">// violation of LSP</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_interface_segregation_principle">Interface Segregation Principle</h3>
<div class="paragraph">
<p>
Clients should not be forced to depend upon interfaces that they do not use.</p>
</div>
<div class="sect3">
<h4 id="_example_without_isp">Example without ISP</h4>
<div class="paragraph">
<p>The following example contains an interface having four methods.
Any implementation of the <code>ICRUDProvider</code> interface need to implement all four methods.
Even if only one method is needed for the decoration <code>CachingCRUDProvider</code> needs to write delegating methods.
This violated the interface segregation principle.
The class has boilerplate code and unnecessary test cases need to be written for this class.</p>
</div>
</div>
<div class="sect3">
<h4 id="_uml_representation_4">UML representation</h4>
<div class="imageblock">
<div class="content">
<img src="images/isp-voilation.png" alt="isp voilation" width="468" height="401">
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">ICRUDProvider</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kt">void</span> <span class="nf">create</span><span class="o">(</span><span class="no">T</span> <span class="n">item</span><span class="o">);</span>
    <span class="no">T</span> <span class="nf">read</span><span class="o">(</span><span class="kt">int</span> <span class="n">id</span><span class="o">);</span>
    <span class="kt">void</span> <span class="nf">update</span><span class="o">(</span><span class="no">T</span> <span class="n">item</span><span class="o">);</span>
    <span class="kt">void</span> <span class="nf">delete</span><span class="o">(</span><span class="no">T</span> <span class="n">item</span><span class="o">);</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">CachingCRUDProvider</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="kd">implements</span> <span class="nc">ICRUDProvider</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">ICRUDProvider</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="n">provider</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">,</span> <span class="no">T</span><span class="o">&gt;</span> <span class="n">itemMap</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;&gt;();</span>

    <span class="kd">public</span> <span class="nf">CachingCRUDProvider</span><span class="o">(</span><span class="nc">ICRUDProvider</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="n">provider</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">provider</span> <span class="o">=</span> <span class="n">provider</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">create</span><span class="o">(</span><span class="no">T</span> <span class="n">item</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">provider</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="n">item</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="no">T</span> <span class="nf">read</span><span class="o">(</span><span class="kt">int</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
        <span class="no">T</span> <span class="n">item</span> <span class="o">=</span> <span class="n">itemMap</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
        <span class="k">if</span><span class="o">(</span> <span class="n">item</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">)</span> <span class="o">{</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">provider</span><span class="o">.</span><span class="na">read</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
            <span class="n">itemMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">id</span><span class="o">,</span> <span class="n">item</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">item</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">update</span><span class="o">(</span><span class="no">T</span> <span class="n">item</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">provider</span><span class="o">.</span><span class="na">update</span><span class="o">(</span><span class="n">item</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">delete</span><span class="o">(</span><span class="no">T</span> <span class="n">item</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">provider</span><span class="o">.</span><span class="na">delete</span><span class="o">(</span><span class="n">item</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Order</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">id</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">double</span> <span class="n">amount</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Order</span><span class="o">(</span><span class="kt">int</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">id</span> <span class="o">=</span> <span class="n">id</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getId</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">id</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">double</span> <span class="nf">getAmount</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">amount</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setAmount</span><span class="o">(</span><span class="kt">double</span> <span class="n">amount</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">amount</span> <span class="o">=</span> <span class="n">amount</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">OrderProvider</span><span class="o">&lt;</span><span class="nc">Order</span><span class="o">&gt;</span> <span class="kd">implements</span> <span class="nc">ICRUDProvider</span><span class="o">&lt;</span><span class="nc">Order</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">create</span><span class="o">(</span><span class="nc">Order</span> <span class="n">item</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// create logic</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">Order</span> <span class="nf">read</span><span class="o">(</span><span class="kt">int</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="o">(</span><span class="nc">Order</span><span class="o">)(</span><span class="k">new</span> <span class="n">com</span><span class="o">.</span><span class="na">company</span><span class="o">.</span><span class="na">example</span><span class="o">.</span><span class="na">Order</span><span class="o">(</span><span class="n">id</span><span class="o">));</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">update</span><span class="o">(</span><span class="nc">Order</span> <span class="n">item</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// update logic</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">delete</span><span class="o">(</span><span class="nc">Order</span> <span class="n">item</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// delete logic</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">OrderController</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">ICRUDProvider</span><span class="o">&lt;</span><span class="nc">Order</span><span class="o">&gt;</span> <span class="n">provider</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">OrderController</span><span class="o">(</span><span class="nc">ICRUDProvider</span><span class="o">&lt;</span><span class="nc">Order</span><span class="o">&gt;</span> <span class="n">provider</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">provider</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CachingCRUDProvider</span><span class="o">(</span><span class="n">provider</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">Order</span> <span class="nf">getOrder</span><span class="o">(</span><span class="kt">int</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">provider</span><span class="o">.</span><span class="na">read</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">OrderControllerTest</span> <span class="o">{</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">test_getOrder</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">OrderProvider</span> <span class="n">provider</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">OrderProvider</span><span class="o">();</span>
        <span class="nc">OrderController</span> <span class="n">orderController</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">OrderController</span><span class="o">(</span><span class="n">provider</span><span class="o">);</span>

        <span class="nc">Order</span> <span class="n">order1</span> <span class="o">=</span> <span class="n">orderController</span><span class="o">.</span><span class="na">getOrder</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">order1</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>

        <span class="nc">Order</span> <span class="n">order2</span> <span class="o">=</span> <span class="n">orderController</span><span class="o">.</span><span class="na">getOrder</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">order1</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>

        <span class="n">assertEquals</span><span class="o">(</span><span class="n">order1</span><span class="o">,</span> <span class="n">order2</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_example_with_isp">Example with ISP</h4>
<div class="paragraph">
<p>The following example modifies the previous example to fix the violation.
There are four different interfaces which are granular.
The <code>OrderProvider</code> class is still single class implementing all four interfaces.
<code>CachingReader</code> implementation now does not need to implement unnecessary methods.</p>
</div>
</div>
<div class="sect3">
<h4 id="_uml_representation_5">UML representation</h4>
<div class="imageblock">
<div class="content">
<img src="images/isp-fix.png" alt="isp fix" width="774" height="401">
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">ICreator</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kt">void</span> <span class="nf">create</span><span class="o">(</span><span class="no">T</span> <span class="n">item</span><span class="o">);</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">IReader</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="no">T</span> <span class="nf">read</span><span class="o">(</span><span class="kt">int</span> <span class="n">id</span><span class="o">);</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">IUpdater</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kt">void</span> <span class="nf">update</span><span class="o">(</span><span class="no">T</span> <span class="n">item</span><span class="o">);</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">IDeleter</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kt">void</span> <span class="nf">delete</span><span class="o">(</span><span class="no">T</span> <span class="n">item</span><span class="o">);</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">CachingReader</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="kd">implements</span> <span class="nc">IReader</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;{</span>
    <span class="kd">private</span> <span class="nc">IReader</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="n">reader</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">,</span> <span class="no">T</span><span class="o">&gt;</span> <span class="n">itemMap</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;&gt;();</span>

    <span class="kd">public</span> <span class="nf">CachingReader</span><span class="o">(</span><span class="nc">IReader</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="n">reader</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">reader</span> <span class="o">=</span> <span class="n">reader</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="no">T</span> <span class="nf">read</span><span class="o">(</span><span class="kt">int</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
        <span class="no">T</span> <span class="n">item</span> <span class="o">=</span> <span class="n">itemMap</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
        <span class="k">if</span><span class="o">(</span> <span class="n">item</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">)</span> <span class="o">{</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="na">read</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
            <span class="n">itemMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">id</span><span class="o">,</span> <span class="n">item</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">item</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">OrderProvider</span><span class="o">&lt;</span><span class="nc">Order</span><span class="o">&gt;</span>
<span class="kd">implements</span> <span class="nc">IReader</span><span class="o">&lt;</span><span class="nc">Order</span><span class="o">&gt;,</span> <span class="nc">IUpdater</span><span class="o">&lt;</span><span class="nc">Order</span><span class="o">&gt;,</span>
    <span class="nc">ICreator</span><span class="o">&lt;</span><span class="nc">Order</span><span class="o">&gt;,</span> <span class="nc">IDeleter</span><span class="o">&lt;</span><span class="nc">Order</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">create</span><span class="o">(</span><span class="nc">Order</span> <span class="n">item</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// create logic</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">Order</span> <span class="nf">read</span><span class="o">(</span><span class="kt">int</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="o">(</span><span class="nc">Order</span><span class="o">)(</span><span class="k">new</span> <span class="n">com</span><span class="o">.</span><span class="na">company</span><span class="o">.</span><span class="na">example</span><span class="o">.</span><span class="na">Order</span><span class="o">(</span><span class="n">id</span><span class="o">));</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">update</span><span class="o">(</span><span class="nc">Order</span> <span class="n">item</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// update logic</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">delete</span><span class="o">(</span><span class="nc">Order</span> <span class="n">item</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// delete logic</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">OrderController</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">IReader</span><span class="o">&lt;</span><span class="nc">Order</span><span class="o">&gt;</span> <span class="n">reader</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">ICreator</span><span class="o">&lt;</span><span class="nc">Order</span><span class="o">&gt;</span> <span class="n">creator</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">IUpdater</span><span class="o">&lt;</span><span class="nc">Order</span><span class="o">&gt;</span> <span class="n">updater</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">IDeleter</span><span class="o">&lt;</span><span class="nc">Order</span><span class="o">&gt;</span> <span class="n">deleter</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">OrderController</span><span class="o">(</span>
        <span class="nc">IReader</span><span class="o">&lt;</span><span class="nc">Order</span><span class="o">&gt;</span> <span class="n">reader</span><span class="o">,</span>
        <span class="nc">ICreator</span><span class="o">&lt;</span><span class="nc">Order</span><span class="o">&gt;</span> <span class="n">creator</span><span class="o">,</span>
        <span class="nc">IUpdater</span><span class="o">&lt;</span><span class="nc">Order</span><span class="o">&gt;</span> <span class="n">updater</span><span class="o">,</span>
        <span class="nc">IDeleter</span><span class="o">&lt;</span><span class="nc">Order</span><span class="o">&gt;</span> <span class="n">deleter</span>
    <span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">reader</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CachingReader</span><span class="o">(</span><span class="n">reader</span><span class="o">);</span>
        <span class="k">this</span><span class="o">.</span><span class="na">creator</span> <span class="o">=</span> <span class="n">creator</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">updater</span> <span class="o">=</span> <span class="n">updater</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">deleter</span> <span class="o">=</span> <span class="n">deleter</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">Order</span> <span class="nf">getOrder</span><span class="o">(</span><span class="kt">int</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">reader</span><span class="o">.</span><span class="na">read</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">OrderControllerTest</span> <span class="o">{</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">test_getOrder</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">OrderProvider</span> <span class="n">provider</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">OrderProvider</span><span class="o">();</span>
        <span class="nc">OrderController</span> <span class="n">orderController</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">OrderController</span><span class="o">(</span>
            <span class="n">provider</span><span class="o">,</span>
            <span class="n">provider</span><span class="o">,</span>
            <span class="n">provider</span><span class="o">,</span>
            <span class="n">provider</span>
        <span class="o">);</span>

        <span class="nc">Order</span> <span class="n">order1</span> <span class="o">=</span> <span class="n">orderController</span><span class="o">.</span><span class="na">getOrder</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">order1</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>

        <span class="nc">Order</span> <span class="n">order2</span> <span class="o">=</span> <span class="n">orderController</span><span class="o">.</span><span class="na">getOrder</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">order1</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>

        <span class="n">assertEquals</span><span class="o">(</span><span class="n">order1</span><span class="o">,</span> <span class="n">order2</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_dependency_inversion_principle">Dependency Inversion Principle</h3>
<div class="paragraph">
<p>
Dependency users should not create dependencies, but should reference the dependencies as interface references.
The dependencies shall be injected by the calling context.
This principle makes the objects loosely coupled and testable.</p>
</div>
<div class="sect3">
<h4 id="_basic_components">Basic Components</h4>
<div class="imageblock">
<div class="content">
<img src="images/dependency-injection.png" alt="dependency injection" width="377" height="277">
</div>
</div>
</div>
<div class="sect3">
<h4 id="_example_without_di">Example Without DI</h4>
<div class="imageblock">
<div class="content">
<img src="images/dependency-without-injection.png" alt="dependency without injection" width="247" height="385">
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Order</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">id</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Order</span><span class="o">(</span><span class="kt">int</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">id</span> <span class="o">=</span> <span class="n">id</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getId</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">id</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Repository</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">save</span><span class="o">(</span><span class="nc">Order</span> <span class="n">order</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// save logic</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Controller</span> <span class="o">{</span>
    <span class="nc">Repository</span> <span class="n">repository</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Repository</span><span class="o">();</span> <i class="conum" data-value="1"></i><b>(1)</b>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">save</span><span class="o">(</span><span class="nc">Order</span> <span class="n">order</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">repository</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">order</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Repository object created here binds this class with the dependency</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">ControllerTest</span> <span class="o">{</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">test_save</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">Controller</span> <span class="n">controller</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Controller</span><span class="o">();</span>
        <span class="nc">Order</span> <span class="n">order</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Order</span><span class="o">(</span><span class="mi">100</span><span class="o">);</span>
        <span class="n">controller</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">order</span><span class="o">);</span> <span class="c1">// no way to verify with mock</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kd">class</span> <span class="nc">MockRepository</span> <span class="kd">extends</span> <span class="nc">Repository</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="nc">Order</span> <span class="n">order</span><span class="o">;</span>

        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">save</span><span class="o">(</span><span class="nc">Order</span> <span class="n">order</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">order</span> <span class="o">=</span> <span class="n">order</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getId</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">order</span><span class="o">.</span><span class="na">getId</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_example_with_di">Example With DI</h4>
<div class="imageblock">
<div class="content">
<img src="images/dependency-with-injection.png" alt="dependency with injection" width="314" height="417">
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Order</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">id</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Order</span><span class="o">(</span><span class="kt">int</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">id</span> <span class="o">=</span> <span class="n">id</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getId</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">id</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Repository</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">save</span><span class="o">(</span><span class="nc">Order</span> <span class="n">order</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// save logic</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Controller</span> <span class="o">{</span>
    <span class="nc">Repository</span> <span class="n">repository</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Controller</span><span class="o">(</span><span class="nc">Repository</span> <span class="n">repository</span><span class="o">)</span> <span class="o">{</span> <i class="conum" data-value="1"></i><b>(1)</b>
        <span class="k">this</span><span class="o">.</span><span class="na">repository</span> <span class="o">=</span> <span class="n">repository</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">save</span><span class="o">(</span><span class="nc">Order</span> <span class="n">order</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">repository</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">order</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Controller is expecting dependency to be injected here</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">ControllerTest</span> <span class="o">{</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">test_save</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">MockRepository</span> <span class="n">repository</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">MockRepository</span><span class="o">();</span>
        <span class="nc">Controller</span> <span class="n">controller</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Controller</span><span class="o">(</span><span class="n">repository</span><span class="o">);</span> <i class="conum" data-value="1"></i><b>(1)</b>
        <span class="nc">Order</span> <span class="n">order</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Order</span><span class="o">(</span><span class="mi">100</span><span class="o">);</span>
        <span class="n">controller</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">order</span><span class="o">);</span>

        <span class="n">assertEquals</span><span class="o">(</span><span class="mi">100</span><span class="o">,</span> <span class="n">repository</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kd">class</span> <span class="nc">MockRepository</span> <span class="kd">extends</span> <span class="nc">Repository</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="nc">Order</span> <span class="n">order</span><span class="o">;</span>

        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">save</span><span class="o">(</span><span class="nc">Order</span> <span class="n">order</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">order</span> <span class="o">=</span> <span class="n">order</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getId</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">order</span><span class="o">.</span><span class="na">getId</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Dependency is injected like this by the Application</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_summary">Summary</h3>
<div class="paragraph">
<p>While applying design patterns to software design keeping the SOLID principles in mind will make the design robust.
SOLID principles help in writing clean code which is maintainable, readable, testable and extensible.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ch02-singleton">Singleton Pattern</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_gof_definition">GoF Definition</h3>
<div class="paragraph">
<p>Ensure a class only has one instance, and provide a global point of access to it.</p>
</div>
</div>
<div class="sect2">
<h3 id="_uml_representation_6">UML Representation</h3>
<div class="imageblock">
<div class="content">
<img src="images/singleton.png" alt="singleton" width="201" height="201">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_eager_initialization">Eager Initialization</h3>
<div class="paragraph">
<p>
.Cache.java</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">package</span> <span class="nn">com.example</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">final</span> <span class="kd">class</span> <span class="nc">Cache</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">Cache</span> <span class="no">INSTANCE</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Cache</span><span class="o">();</span>

    <span class="kd">private</span> <span class="nf">Cache</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// avoid initialization</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">Cache</span> <span class="nf">getInstance</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="no">INSTANCE</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_lazy_loading_with_thread_safety">Lazy Loading with thread safety</h3>
<div class="paragraph">
<p>
.Cache.java</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">package</span> <span class="nn">com.example</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">final</span> <span class="kd">class</span> <span class="nc">Cache</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="nc">Cache</span> <span class="n">cache</span><span class="o">;</span>

    <span class="kd">private</span> <span class="nf">Cache</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// avoid initialization</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">synchronized</span> <span class="nc">Cache</span> <span class="nf">getInstance</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">if</span><span class="o">(</span> <span class="n">cache</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">cache</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Cache</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">cache</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_lazy_loading_with_double_checked_locking">Lazy Loading with Double Checked Locking</h3>
<div class="paragraph">
<p>
.Cache.java</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">package</span> <span class="nn">com.example</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">final</span> <span class="kd">class</span> <span class="nc">Cache</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="nc">Cache</span> <span class="n">cache</span><span class="o">;</span>

    <span class="kd">private</span> <span class="nf">Cache</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// avoid initialization</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">Cache</span> <span class="nf">getInstance</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">if</span><span class="o">(</span> <span class="n">cache</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="kd">synchronized</span><span class="o">(</span><span class="nc">Cache</span><span class="o">.</span><span class="na">class</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">if</span><span class="o">(</span> <span class="n">cache</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">cache</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Cache</span><span class="o">();</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">cache</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_bill_pughs_static_helper">Bill Pugh&#8217;s Static Helper</h3>
<div class="paragraph">
<p>
.Cache.java</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">package</span> <span class="nn">com.example</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">final</span> <span class="kd">class</span> <span class="nc">Cache</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">SingletonHelper</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">Cache</span> <span class="no">INSTANCE</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Cache</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="nf">Cache</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// avoid initialization</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">Cache</span> <span class="nf">getInstance</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nc">SingletonHelper</span><span class="o">.</span><span class="na">INSTANCE</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_interface_based_implementation">Interface Based Implementation</h3>
<div class="paragraph">
<p>
.Cache.java</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">package</span> <span class="nn">com.example</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.Map</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.HashMap</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">final</span> <span class="kd">class</span> <span class="nc">Cache</span> <span class="kd">implements</span> <span class="nc">ICache</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">Cache</span> <span class="no">INSTANCE</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Cache</span><span class="o">();</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="n">cacheMap</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;&gt;();</span>

    <span class="kd">private</span> <span class="nf">Cache</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// avoid initialization</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">ICache</span> <span class="nf">getInstance</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="no">INSTANCE</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getValue</span><span class="o">(</span><span class="nc">String</span> <span class="n">key</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">cacheMap</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">key</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setValue</span><span class="o">(</span><span class="nc">String</span> <span class="n">key</span><span class="o">,</span> <span class="nc">String</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">cacheMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">value</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_spring_boot_version">Spring Boot Version</h3>
<div class="paragraph">
<p></p>
</div>
<div class="listingblock">
<div class="title">Cache.java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">package</span> <span class="nn">com.example</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Component</span><span class="o">;</span>

<span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Cache</span> <span class="o">{</span>

<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">AcceptList.java</div>
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">package</span> <span class="nn">com.example</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.beans.factory.annotation.Autowired</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Component</span><span class="o">;</span>

<span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">AcceptList</span> <span class="o">{</span>

	<span class="nd">@Autowired</span>
    <span class="nc">Cache</span> <span class="n">cache</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nc">Cache</span> <span class="nf">getCache</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">cache</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_singleton_and_enum_by_joshua_bloch">Singleton and Enum by Joshua Bloch</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kn">package</span> <span class="nn">com.journaldev.singleton</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">enum</span> <span class="nc">Cache</span> <span class="o">{</span>

    <span class="no">INSTANCE</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">doSomething</span><span class="o">(){</span>
        <span class="c1">//do something</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_singleton_and_reflection">Singleton and reflection</h3>
<div class="paragraph">
<p>
Singleton objects can be instantiated using reflection and hence the objective can be overridden using reflection</p>
</div>
</div>
<div class="sect2">
<h3 id="_singleton_and_serialization">Singleton and serialization</h3>
<div class="paragraph">
<p>
If the singleton class supports serialization then it can be serialized and deserialized to override the objective of maintaining one instance.</p>
</div>
</div>
<div class="sect2">
<h3 id="_singleton_instances_in_jdk">Singleton Instances in JDK</h3>
<div class="paragraph">
<p>
Singleton examples in Java core libraries:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>java.lang.Runtime#getRuntime()</p>
</li>
<li>
<p>java.awt.Desktop#getDesktop()</p>
</li>
<li>
<p>java.lang.System#getSecurityManager()</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_singleton_example_in_go">Singleton example in Go</h3>
<div class="paragraph">
<p>TBD</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/singleton.png" alt="singleton" width="268" height="466">
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="go"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
</pre></td><td class="code"><pre><span class="k">package</span> <span class="n">cache</span>

<span class="k">import</span> <span class="p">(</span>
	<span class="s">"fmt"</span>
	<span class="s">"sync"</span>

	<span class="s">"github.com/rs/zerolog/log"</span>
<span class="p">)</span>

<span class="c">// Cache is reference to a cache instance.</span>
<span class="c">// A Cache is safe for concurrent use by multiple goroutines.</span>
<span class="k">type</span> <span class="n">Cache</span><span class="p">[</span><span class="n">T</span> <span class="n">any</span><span class="p">]</span> <span class="k">interface</span> <span class="p">{</span>
	<span class="c">// Get returns value stored for key and exists=true.</span>
	<span class="c">//</span>
	<span class="c">// When value is not found exists=false is returned.</span>
	<span class="n">Get</span><span class="p">(</span><span class="n">key</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="n">value</span> <span class="n">T</span><span class="p">,</span> <span class="n">exists</span> <span class="kt">bool</span><span class="p">)</span>

	<span class="c">// Set stores the value for given key</span>
	<span class="n">Set</span><span class="p">(</span><span class="n">key</span> <span class="kt">string</span><span class="p">,</span> <span class="n">value</span> <span class="n">T</span><span class="p">)</span>
<span class="p">}</span>

<span class="k">type</span> <span class="n">cache</span><span class="p">[</span><span class="n">T</span> <span class="n">any</span><span class="p">]</span> <span class="k">struct</span> <span class="p">{</span>
	<span class="n">mutex</span> <span class="n">sync</span><span class="o">.</span><span class="n">RWMutex</span>
	<span class="n">items</span> <span class="k">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="k">interface</span><span class="p">{}</span>
<span class="p">}</span>

<span class="k">var</span> <span class="p">(</span>
	<span class="n">instance</span> <span class="n">Cache</span><span class="p">[</span><span class="n">any</span><span class="p">]</span>
	<span class="n">once</span>     <span class="n">sync</span><span class="o">.</span><span class="n">Once</span>
<span class="p">)</span>

<span class="k">func</span> <span class="n">createCacheInstance</span><span class="p">[</span><span class="n">T</span> <span class="n">any</span><span class="p">]()</span> <span class="p">{</span>
	<span class="n">instance</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">cache</span><span class="p">[</span><span class="n">any</span><span class="p">]{</span>
		<span class="n">items</span><span class="o">:</span> <span class="nb">make</span><span class="p">(</span><span class="k">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="k">interface</span><span class="p">{}),</span>
	<span class="p">}</span>
	<span class="n">log</span><span class="o">.</span><span class="n">Info</span><span class="p">()</span><span class="o">.</span><span class="n">Msg</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">Sprintf</span><span class="p">(</span><span class="s">"Cache instance created for type %T"</span><span class="p">,</span> <span class="o">*</span><span class="nb">new</span><span class="p">(</span><span class="n">T</span><span class="p">)))</span>
<span class="p">}</span>

<span class="c">// GetInstance returns singleton instance of Cache</span>
<span class="k">func</span> <span class="n">GetInstance</span><span class="p">[</span><span class="n">T</span> <span class="n">any</span><span class="p">]()</span> <span class="n">Cache</span><span class="p">[</span><span class="n">any</span><span class="p">]</span> <span class="p">{</span>
	<span class="n">once</span><span class="o">.</span><span class="n">Do</span><span class="p">(</span><span class="n">createCacheInstance</span><span class="p">[</span><span class="n">T</span><span class="p">])</span>
	<span class="k">return</span> <span class="n">instance</span>
<span class="p">}</span>

<span class="k">func</span> <span class="p">(</span><span class="n">c</span> <span class="o">*</span><span class="n">cache</span><span class="p">[</span><span class="n">T</span><span class="p">])</span> <span class="n">Set</span><span class="p">(</span><span class="n">key</span> <span class="kt">string</span><span class="p">,</span> <span class="n">value</span> <span class="n">T</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">c</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
	<span class="k">defer</span> <span class="n">c</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">Unlock</span><span class="p">()</span>
	<span class="n">c</span><span class="o">.</span><span class="n">items</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
<span class="p">}</span>

<span class="k">func</span> <span class="p">(</span><span class="n">c</span> <span class="o">*</span><span class="n">cache</span><span class="p">[</span><span class="n">T</span><span class="p">])</span> <span class="n">Get</span><span class="p">(</span><span class="n">key</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="n">value</span> <span class="n">T</span><span class="p">,</span> <span class="n">exists</span> <span class="kt">bool</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">c</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">RLock</span><span class="p">()</span>
	<span class="k">defer</span> <span class="n">c</span><span class="o">.</span><span class="n">mutex</span><span class="o">.</span><span class="n">RUnlock</span><span class="p">()</span>
	<span class="n">rawValue</span><span class="p">,</span> <span class="n">exists</span> <span class="o">:=</span> <span class="n">c</span><span class="o">.</span><span class="n">items</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
	<span class="k">if</span> <span class="n">exists</span> <span class="p">{</span>
		<span class="n">value</span> <span class="o">=</span> <span class="n">rawValue</span><span class="o">.</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">value</span><span class="p">,</span> <span class="n">exists</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="go"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
</pre></td><td class="code"><pre><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="p">(</span>
	<span class="s">"fmt"</span>
	<span class="s">"singleton/cache"</span>
	<span class="s">"sync"</span>

	<span class="s">"github.com/rs/zerolog/log"</span>
<span class="p">)</span>

<span class="k">func</span> <span class="n">process</span><span class="p">(</span><span class="n">index</span> <span class="kt">int</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">cache</span> <span class="o">:=</span> <span class="n">cache</span><span class="o">.</span><span class="n">GetInstance</span><span class="p">[</span><span class="kt">string</span><span class="p">]()</span>
	<span class="n">cache</span><span class="o">.</span><span class="n">Set</span><span class="p">(</span><span class="s">"one"</span><span class="p">,</span> <span class="n">fmt</span><span class="o">.</span><span class="n">Sprintf</span><span class="p">(</span><span class="s">"one:%d"</span><span class="p">,</span> <span class="n">index</span><span class="p">))</span>
	<span class="n">cache</span><span class="o">.</span><span class="n">Set</span><span class="p">(</span><span class="s">"two"</span><span class="p">,</span> <span class="n">fmt</span><span class="o">.</span><span class="n">Sprintf</span><span class="p">(</span><span class="s">"two:%d"</span><span class="p">,</span> <span class="n">index</span><span class="p">))</span>

	<span class="n">value</span><span class="p">,</span> <span class="n">exist</span> <span class="o">:=</span> <span class="n">cache</span><span class="o">.</span><span class="n">Get</span><span class="p">(</span><span class="s">"one"</span><span class="p">)</span>
	<span class="k">if</span> <span class="n">exist</span> <span class="p">{</span>
		<span class="n">log</span><span class="o">.</span><span class="n">Info</span><span class="p">()</span><span class="o">.</span><span class="n">Msg</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">Sprintf</span><span class="p">(</span><span class="s">"Process: %d, Value: %s"</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
	<span class="p">}</span>

	<span class="n">value2</span><span class="p">,</span> <span class="n">exist</span> <span class="o">:=</span> <span class="n">cache</span><span class="o">.</span><span class="n">Get</span><span class="p">(</span><span class="s">"two"</span><span class="p">)</span>
	<span class="k">if</span> <span class="n">exist</span> <span class="p">{</span>
		<span class="n">log</span><span class="o">.</span><span class="n">Info</span><span class="p">()</span><span class="o">.</span><span class="n">Msg</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">Sprintf</span><span class="p">(</span><span class="s">"Process: %d, Value: %s"</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">value2</span><span class="p">))</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">waitGroup</span> <span class="o">:=</span> <span class="n">sync</span><span class="o">.</span><span class="n">WaitGroup</span><span class="p">{}</span>
	<span class="k">for</span> <span class="n">i</span> <span class="o">:=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="m">5</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span> <span class="p">{</span>
		<span class="n">waitGroup</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="m">1</span><span class="p">)</span>
		<span class="k">go</span> <span class="k">func</span><span class="p">()</span> <span class="p">{</span>
			<span class="k">defer</span> <span class="n">waitGroup</span><span class="o">.</span><span class="n">Done</span><span class="p">()</span>
			<span class="n">process</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
		<span class="p">}()</span>
	<span class="p">}</span>
	<span class="n">waitGroup</span><span class="o">.</span><span class="n">Wait</span><span class="p">()</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ch03-factory">Factory Pattern</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_gof_definition_2">GoF Definition</h3>
<div class="paragraph">
<p>Define an interface for creating an object, but let subclasses decide which class to instantiate. Factory Method lets a class defer instantiation to subclasses.</p>
</div>
</div>
<div class="sect2">
<h3 id="_things_to_note_about_factory_pattern">Things to note about Factory Pattern</h3>
<div class="ulist">
<ul>
<li>
<p>This pattern caters to creation of objects of specific interface/class, let us call it <code>Product</code></p>
</li>
<li>
<p>The term interface is referred as a generic concept that is a contract expressed for the calling code to expect in the <code>Product</code></p>
</li>
<li>
<p>Factory or Creator class is used to create the objects of the specific interface</p>
</li>
<li>
<p>The concrete implementation which is returned from the <code>Factory</code> method is not known to the calling code</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_uml_interpretation">UML Interpretation</h3>
<div class="imageblock">
<div class="content">
<img src="images/basic-factory.png" alt="basic factory" width="483" height="277">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_basic_factory">Basic Factory</h3>
<div class="paragraph">
<p></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">IShape</span> <span class="o">{</span>
    <span class="nc">String</span> <span class="nf">getName</span><span class="o">();</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">IShapeFactory</span> <span class="o">{</span>
    <span class="nc">IShape</span> <span class="nf">create</span><span class="o">(</span><span class="nc">String</span> <span class="n">type</span><span class="o">);</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Circle</span> <span class="kd">implements</span> <span class="nc">IShape</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getName</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">"Circle"</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Rectangle</span> <span class="kd">implements</span> <span class="nc">IShape</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getName</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">"Rectangle"</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">BasicShapeFactory</span> <span class="kd">implements</span> <span class="nc">IShapeFactory</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nc">IShape</span> <span class="nf">create</span><span class="o">(</span><span class="nc">String</span> <span class="n">type</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span><span class="o">(</span> <span class="s">"CIRCLE"</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">type</span><span class="o">))</span> <span class="o">{</span>
            <span class="k">return</span> <span class="k">new</span> <span class="nf">Circle</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">else</span> <span class="k">if</span><span class="o">(</span> <span class="s">"RECTANGLE"</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">type</span><span class="o">))</span> <span class="o">{</span>
            <span class="k">return</span> <span class="k">new</span> <span class="nf">Rectangle</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">BasicShapeFactoryTest</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="nc">BasicShapeFactory</span> <span class="n">target</span><span class="o">;</span>

    <span class="nd">@BeforeEach</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">beforeEach</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">target</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BasicShapeFactory</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">check_object_created</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">IShape</span> <span class="n">circle</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="s">"CIRCLE"</span><span class="o">);</span>
        <span class="nc">IShape</span> <span class="n">rectangle</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="s">"RECTANGLE"</span><span class="o">);</span>

        <span class="n">assertEquals</span><span class="o">(</span><span class="s">"Circle"</span><span class="o">,</span> <span class="n">circle</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="s">"Rectangle"</span><span class="o">,</span> <span class="n">rectangle</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">check_object_are_not_same</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">IShape</span> <span class="n">circle1</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="s">"CIRCLE"</span><span class="o">);</span>
        <span class="nc">IShape</span> <span class="n">circle2</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="s">"CIRCLE"</span><span class="o">);</span>

        <span class="n">assertNotEquals</span><span class="o">(</span><span class="n">circle1</span><span class="o">,</span> <span class="n">circle2</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">check_invalid_type_returns_null</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">IShape</span> <span class="n">unknown</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="s">"UNKNOWN"</span><span class="o">);</span>

        <span class="n">assertNull</span><span class="o">(</span><span class="n">unknown</span><span class="o">);</span>
    <span class="o">}</span>

<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_loose_coupling">Loose Coupling</h3>
<div class="paragraph">
<p>
Factory pattern can help achieve loose coupling between components.</p>
</div>
<div class="paragraph">
<p><code>IAuditor</code> interface declares the expectation contract of an Auditor object.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">IAuditor</span> <span class="o">{</span>
    <span class="kt">void</span> <span class="nf">log</span><span class="o">(</span><span class="nc">String</span> <span class="n">message</span><span class="o">);</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>AuditorFactory</code> class decides which concrete Auditor class to instantiate.  This separates the decision of which Auditor to use from the actual calling components.</p>
</div>
<div class="paragraph">
<p>The decision of choosing a specific auditor can be externalized as a property declaration or even an environmental variable declaration in the <code>AuditorFactory</code> class.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">AuditorFactory</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">IAuditor</span> <span class="nf">create</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">FileSystemAuditor</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_encapsulation_using_factory">Encapsulation using Factory</h3>
<div class="paragraph">
<p>
Factory can encapsulate complex logic of building the service.  The logic of creating additional dependencies and building the <code>IClaimCalculator</code> is encapsulated in the <code>ClaimCalculatorFactory</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ClaimCalculatorFactory</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">IClaimCalculator</span> <span class="nf">create</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">RuleList</span> <span class="n">ruleList</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">RuleList</span><span class="o">();</span>
        <span class="nc">FixedConditions</span> <span class="n">fixedConditions</span> <span class="o">=</span>  <span class="k">new</span> <span class="nc">FixedConditions</span><span class="o">();</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">StandardClaimCalculator</span><span class="o">(</span><span class="n">ruleList</span><span class="o">,</span> <span class="n">fixedConditions</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ClaimCreator</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">double</span> <span class="nf">create</span><span class="o">(</span><span class="nc">String</span> <span class="n">code</span><span class="o">,</span> <span class="kt">double</span> <span class="n">amount</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">IClaimCalculator</span> <span class="n">claimCalculator</span> <span class="o">=</span> <span class="nc">ClaimCalculatorFactory</span><span class="o">.</span><span class="na">create</span><span class="o">();</span>
        <span class="k">return</span> <span class="n">claimCalculator</span><span class="o">.</span><span class="na">calculateClaimAmount</span><span class="o">(</span><span class="n">code</span><span class="o">,</span> <span class="n">amount</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_factory_instances_in_jdk">Factory instances in JDK</h3>
<div class="paragraph">
<p>
Factory examples in Java core libraries:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>java.util.Calendar#getInstance()</p>
</li>
<li>
<p>java.util.ResourceBundle#getBundle()</p>
</li>
<li>
<p>java.text.NumberFormat#getInstance()</p>
</li>
<li>
<p>java.nio.charset.Charset#forName()</p>
</li>
<li>
<p>java.net.URLStreamHandlerFactory#createURLStreamHandler(String)</p>
</li>
<li>
<p>java.util.EnumSet#of()</p>
</li>
<li>
<p>javax.xml.bind.JAXBContext#createMarshaller()</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ch04-abstract-factory">Abstract Factory Pattern</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_gof_definition_3">GoF Definition</h3>
<div class="paragraph">
<p>Provide an interface for creating families of related or dependent objects without specifying their concrete classes.</p>
</div>
</div>
<div class="sect2">
<h3 id="_block_diagram">Block Diagram</h3>
<div class="imageblock">
<div class="content">
<img src="images/ch04-abstract-factory/abstract-factory.png" alt="Abstract Factory Pattern Components.">
</div>
<div class="title">Figure 1. Image Components of Abstract Factory Pattern</div>
</div>
</div>
<div class="sect2">
<h3 id="_uml_representation_7">UML Representation</h3>
<div class="imageblock">
<div class="content">
<img src="images/abstract-factory.png" alt="abstract factory" width="1240" height="277">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ui_tools_example">UI Tools Example</h3>
<div class="paragraph">
<p>
<code>IUIToolsFactory</code> is public contract for any factory to satisfy.  Any class implementing this interface agrees to provide a factory for three product interfaces <code>IShape</code>, <code>IToolButton</code> and <code>IMenuList</code>.</p>
</div>
<div class="paragraph">
<p>A set of Factory class and concrete product classes is created as one option for the factory implementation.</p>
</div>
<div class="paragraph">
<p>Similarly another Factory implementation is made available which can be replaced in the constructor of <code>Application</code> class to switch the products from one set of or family of products to another family of products.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Application</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">IUIToolsFactory</span> <span class="n">toolsFactory</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">IToolButton</span> <span class="n">toolButton</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">IShape</span> <span class="n">shape</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">IMenuList</span> <span class="n">menuList</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Application</span><span class="o">(</span><span class="nc">IUIToolsFactory</span> <span class="n">toolsFactory</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">toolsFactory</span> <span class="o">=</span> <span class="n">toolsFactory</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">toolButton</span> <span class="o">=</span> <span class="n">toolsFactory</span><span class="o">.</span><span class="na">createToolButton</span><span class="o">(</span><span class="s">"TOOL_1"</span><span class="o">);</span>
        <span class="k">this</span><span class="o">.</span><span class="na">shape</span> <span class="o">=</span> <span class="n">toolsFactory</span><span class="o">.</span><span class="na">createShape</span><span class="o">(</span><span class="s">"CIRCLE"</span><span class="o">);</span>
        <span class="k">this</span><span class="o">.</span><span class="na">menuList</span> <span class="o">=</span> <span class="n">toolsFactory</span><span class="o">.</span><span class="na">createMenuList</span><span class="o">(</span><span class="s">"FILE"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">IShape</span> <span class="nf">getShape</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">shape</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">IToolButton</span> <span class="nf">getToolButton</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">toolButton</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">IMenuList</span> <span class="nf">getMenuList</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">menuList</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">IUIToolsFactory</span> <span class="o">{</span>
    <span class="nc">IToolButton</span> <span class="nf">createToolButton</span><span class="o">(</span><span class="nc">String</span> <span class="n">type</span><span class="o">);</span>
    <span class="nc">IShape</span> <span class="nf">createShape</span><span class="o">(</span><span class="nc">String</span> <span class="n">type</span><span class="o">);</span>
    <span class="nc">IMenuList</span> <span class="nf">createMenuList</span><span class="o">(</span><span class="nc">String</span> <span class="n">type</span><span class="o">);</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">IMenuList</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getName</span><span class="o">();</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">IToolButton</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getName</span><span class="o">();</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">IShape</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getName</span><span class="o">();</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">BasicToolsFactory</span> <span class="kd">implements</span> <span class="nc">IUIToolsFactory</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nc">IToolButton</span> <span class="nf">createToolButton</span><span class="o">(</span><span class="nc">String</span> <span class="n">type</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">BasicToolButton</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">IShape</span> <span class="nf">createShape</span><span class="o">(</span><span class="nc">String</span> <span class="n">type</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">BasicShape</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">IMenuList</span> <span class="nf">createMenuList</span><span class="o">(</span><span class="nc">String</span> <span class="n">type</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">BasicMenuList</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">AdvancedToolsFactory</span> <span class="kd">implements</span> <span class="nc">IUIToolsFactory</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nc">IToolButton</span> <span class="nf">createToolButton</span><span class="o">(</span><span class="nc">String</span> <span class="n">type</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">AdvancedToolButton</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">IShape</span> <span class="nf">createShape</span><span class="o">(</span><span class="nc">String</span> <span class="n">type</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">AdvancedShape</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">IMenuList</span> <span class="nf">createMenuList</span><span class="o">(</span><span class="nc">String</span> <span class="n">type</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">AdvancedMenuList</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">ApplicationTest</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="nc">Application</span> <span class="n">application</span><span class="o">;</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">check_basic_tools_factory</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">IUIToolsFactory</span> <span class="n">toolsFactory</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BasicToolsFactory</span><span class="o">();</span>
        <span class="n">application</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Application</span><span class="o">(</span><span class="n">toolsFactory</span><span class="o">);</span>

        <span class="n">assertEquals</span><span class="o">(</span><span class="s">"BasicShape"</span><span class="o">,</span> <span class="n">application</span><span class="o">.</span><span class="na">getShape</span><span class="o">().</span><span class="na">getName</span><span class="o">());</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="s">"BasicToolButton"</span><span class="o">,</span> <span class="n">application</span><span class="o">.</span><span class="na">getToolButton</span><span class="o">().</span><span class="na">getName</span><span class="o">());</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="s">"BasicMenuList"</span><span class="o">,</span> <span class="n">application</span><span class="o">.</span><span class="na">getMenuList</span><span class="o">().</span><span class="na">getName</span><span class="o">());</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">check_advanced_tools_factory</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">IUIToolsFactory</span> <span class="n">toolsFactory</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">AdvancedToolsFactory</span><span class="o">();</span>
        <span class="n">application</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Application</span><span class="o">(</span><span class="n">toolsFactory</span><span class="o">);</span>

        <span class="n">assertEquals</span><span class="o">(</span><span class="s">"AdvancedShape"</span><span class="o">,</span> <span class="n">application</span><span class="o">.</span><span class="na">getShape</span><span class="o">().</span><span class="na">getName</span><span class="o">());</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="s">"AdvancedToolButton"</span><span class="o">,</span> <span class="n">application</span><span class="o">.</span><span class="na">getToolButton</span><span class="o">().</span><span class="na">getName</span><span class="o">());</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="s">"AdvancedMenuList"</span><span class="o">,</span> <span class="n">application</span><span class="o">.</span><span class="na">getMenuList</span><span class="o">().</span><span class="na">getName</span><span class="o">());</span>
    <span class="o">}</span>

<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_separated_interface_1">Separated Interface.<sup class="footnote">[<a id="_footnoteref_1" class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup></h3>
<div class="imageblock">
<div class="content">
<img src="images/abstract-factory-intf-sep.png" alt="abstract factory intf sep" width="1798" height="543">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_abstract_factory_instances_in_jdk">Abstract Factory instances in JDK</h3>
<div class="ulist">
<ul>
<li>
<p>javax.xml.parsers.DocumentBuilderFactory#newInstance()</p>
</li>
<li>
<p>javax.xml.transform.TransformerFactory#newInstance()</p>
</li>
<li>
<p>javax.xml.xpath.XPathFactory#newInstance()</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ch05-builder">Builder Pattern</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_gof_definition_4">GoF Definition</h3>
<div class="paragraph">
<p>Separate the construction of a complex object from its representation so that the same construction processes can create different representations.</p>
</div>
</div>
<div class="sect2">
<h3 id="_uml_interpretation_2">UML Interpretation</h3>
<div class="imageblock">
<div class="content">
<img src="images/builder.png" alt="builder" width="157" height="385">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_resume_builder_example">Resume Builder Example</h3>
<div class="paragraph">
<p></p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/resume-builder.png" alt="resume builder" width="450" height="401">
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">IResumeBuilder</span> <span class="o">{</span>
    <span class="kt">void</span> <span class="nf">createEducationDetails</span><span class="o">();</span>
    <span class="kt">void</span> <span class="nf">createProjectDetails</span><span class="o">();</span>
    <span class="kt">void</span> <span class="nf">createSocialDetails</span><span class="o">();</span>
    <span class="kt">void</span> <span class="nf">createTestimonialDetails</span><span class="o">();</span>
    <span class="kt">void</span> <span class="nf">createPersonalDetails</span><span class="o">();</span>
    <span class="kt">void</span> <span class="nf">createCertificationDetails</span><span class="o">();</span>
    <span class="kt">void</span> <span class="nf">createNameAndTitle</span><span class="o">();</span>
    <span class="nc">Resume</span> <span class="nf">build</span><span class="o">();</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Resume</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">sectionList</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;();</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">addSection</span><span class="o">(</span><span class="nc">String</span> <span class="n">section</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">sectionList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">section</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">StringBuilder</span> <span class="n">builder</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">StringBuilder</span><span class="o">();</span>
        <span class="k">for</span><span class="o">(</span><span class="nc">String</span> <span class="n">section</span> <span class="o">:</span> <span class="n">sectionList</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">builder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">section</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">builder</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">AbstractResumeBuilder</span> <span class="kd">implements</span> <span class="nc">IResumeBuilder</span> <span class="o">{</span>

    <span class="nc">Resume</span> <span class="n">resume</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Resume</span><span class="o">();</span>

    <span class="kd">public</span> <span class="nc">Resume</span> <span class="nf">build</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">Resume</span> <span class="n">resumeToReturn</span> <span class="o">=</span> <span class="n">resume</span><span class="o">;</span>
        <span class="n">resume</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Resume</span><span class="o">();</span>
        <span class="k">return</span> <span class="n">resumeToReturn</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ResumeMaker</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="nc">IResumeBuilder</span> <span class="n">builder</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">ResumeMaker</span><span class="o">(</span><span class="nc">IResumeBuilder</span> <span class="n">builder</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">builder</span> <span class="o">=</span> <span class="n">builder</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">makeCV</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">builder</span><span class="o">.</span><span class="na">createNameAndTitle</span><span class="o">();</span>
        <span class="n">builder</span><span class="o">.</span><span class="na">createProjectDetails</span><span class="o">();</span>
        <span class="n">builder</span><span class="o">.</span><span class="na">createTestimonialDetails</span><span class="o">();</span>
        <span class="n">builder</span><span class="o">.</span><span class="na">createCertificationDetails</span><span class="o">();</span>
        <span class="n">builder</span><span class="o">.</span><span class="na">createEducationDetails</span><span class="o">();</span>
        <span class="n">builder</span><span class="o">.</span><span class="na">createSocialDetails</span><span class="o">();</span>
        <span class="n">builder</span><span class="o">.</span><span class="na">createPersonalDetails</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">makeResume</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">builder</span><span class="o">.</span><span class="na">createNameAndTitle</span><span class="o">();</span>
        <span class="n">builder</span><span class="o">.</span><span class="na">createProjectDetails</span><span class="o">();</span>
        <span class="n">builder</span><span class="o">.</span><span class="na">createCertificationDetails</span><span class="o">();</span>
        <span class="n">builder</span><span class="o">.</span><span class="na">createEducationDetails</span><span class="o">();</span>
        <span class="n">builder</span><span class="o">.</span><span class="na">createPersonalDetails</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">makeOnePagerResume</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">builder</span><span class="o">.</span><span class="na">createNameAndTitle</span><span class="o">();</span>
        <span class="n">builder</span><span class="o">.</span><span class="na">createProjectDetails</span><span class="o">();</span>
        <span class="n">builder</span><span class="o">.</span><span class="na">createPersonalDetails</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ProfessionalResumeBuilder</span> <span class="kd">extends</span> <span class="nc">AbstractResumeBuilder</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">createEducationDetails</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">resume</span><span class="o">.</span><span class="na">addSection</span><span class="o">(</span><span class="s">"Professional Education"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">createProjectDetails</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">resume</span><span class="o">.</span><span class="na">addSection</span><span class="o">(</span><span class="s">"Professional Projects"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">createSocialDetails</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">resume</span><span class="o">.</span><span class="na">addSection</span><span class="o">(</span><span class="s">"Professional Social"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">createTestimonialDetails</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">resume</span><span class="o">.</span><span class="na">addSection</span><span class="o">(</span><span class="s">"Professional Testimonials"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">createPersonalDetails</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">resume</span><span class="o">.</span><span class="na">addSection</span><span class="o">(</span><span class="s">"Professional Personal"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">createCertificationDetails</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">resume</span><span class="o">.</span><span class="na">addSection</span><span class="o">(</span><span class="s">"Professional Certifications"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">createNameAndTitle</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">resume</span><span class="o">.</span><span class="na">addSection</span><span class="o">(</span><span class="s">"Professional NameAndTitle"</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SocialResumeBuilder</span> <span class="kd">extends</span> <span class="nc">AbstractResumeBuilder</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">createEducationDetails</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">resume</span><span class="o">.</span><span class="na">addSection</span><span class="o">(</span><span class="s">"Social Education"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">createProjectDetails</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">resume</span><span class="o">.</span><span class="na">addSection</span><span class="o">(</span><span class="s">"Social Projects"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">createSocialDetails</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">resume</span><span class="o">.</span><span class="na">addSection</span><span class="o">(</span><span class="s">"Social Social"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">createTestimonialDetails</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">resume</span><span class="o">.</span><span class="na">addSection</span><span class="o">(</span><span class="s">"Social Testimonials"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">createPersonalDetails</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">resume</span><span class="o">.</span><span class="na">addSection</span><span class="o">(</span><span class="s">"Social Personal"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">createCertificationDetails</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">resume</span><span class="o">.</span><span class="na">addSection</span><span class="o">(</span><span class="s">"Social Certifications"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">createNameAndTitle</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">resume</span><span class="o">.</span><span class="na">addSection</span><span class="o">(</span><span class="s">"Social NameAndTitle"</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">ResumeMakerTest</span> <span class="o">{</span>

    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">ensure_professional_cv</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">IResumeBuilder</span> <span class="n">builder</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ProfessionalResumeBuilder</span><span class="o">();</span>
        <span class="nc">ResumeMaker</span> <span class="n">maker</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ResumeMaker</span><span class="o">(</span><span class="n">builder</span><span class="o">);</span>
        <span class="n">maker</span><span class="o">.</span><span class="na">makeCV</span><span class="o">();</span>
        <span class="nc">Resume</span> <span class="n">resume</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="na">build</span><span class="o">();</span>

        <span class="nc">String</span> <span class="n">cvText</span> <span class="o">=</span> <span class="s">"Professional NameAndTitle"</span>
                        <span class="o">+</span> <span class="s">"Professional Projects"</span>
                        <span class="o">+</span> <span class="s">"Professional Testimonials"</span>
                        <span class="o">+</span> <span class="s">"Professional Certifications"</span>
                        <span class="o">+</span> <span class="s">"Professional Education"</span>
                        <span class="o">+</span> <span class="s">"Professional Social"</span>
                        <span class="o">+</span> <span class="s">"Professional Personal"</span><span class="o">;</span>

        <span class="n">assertEquals</span><span class="o">(</span><span class="n">cvText</span><span class="o">,</span> <span class="n">resume</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">ensure_professional_resume</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">IResumeBuilder</span> <span class="n">builder</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ProfessionalResumeBuilder</span><span class="o">();</span>
        <span class="nc">ResumeMaker</span> <span class="n">maker</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ResumeMaker</span><span class="o">(</span><span class="n">builder</span><span class="o">);</span>
        <span class="n">maker</span><span class="o">.</span><span class="na">makeResume</span><span class="o">();</span>
        <span class="nc">Resume</span> <span class="n">resume</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="na">build</span><span class="o">();</span>

        <span class="nc">String</span> <span class="n">cvText</span> <span class="o">=</span> <span class="s">"Professional NameAndTitle"</span>
                        <span class="o">+</span> <span class="s">"Professional Projects"</span>
                        <span class="o">+</span> <span class="s">"Professional Certifications"</span>
                        <span class="o">+</span> <span class="s">"Professional Education"</span>
                        <span class="o">+</span> <span class="s">"Professional Personal"</span><span class="o">;</span>

        <span class="n">assertEquals</span><span class="o">(</span><span class="n">cvText</span><span class="o">,</span> <span class="n">resume</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">ensure_professional_one_pager</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">IResumeBuilder</span> <span class="n">builder</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ProfessionalResumeBuilder</span><span class="o">();</span>
        <span class="nc">ResumeMaker</span> <span class="n">maker</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ResumeMaker</span><span class="o">(</span><span class="n">builder</span><span class="o">);</span>
        <span class="n">maker</span><span class="o">.</span><span class="na">makeOnePagerResume</span><span class="o">();</span>
        <span class="nc">Resume</span> <span class="n">resume</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="na">build</span><span class="o">();</span>

        <span class="nc">String</span> <span class="n">cvText</span> <span class="o">=</span> <span class="s">"Professional NameAndTitle"</span>
                        <span class="o">+</span> <span class="s">"Professional Projects"</span>
                        <span class="o">+</span> <span class="s">"Professional Personal"</span><span class="o">;</span>

        <span class="n">assertEquals</span><span class="o">(</span><span class="n">cvText</span><span class="o">,</span> <span class="n">resume</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">ensure_social_cv</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">IResumeBuilder</span> <span class="n">builder</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SocialResumeBuilder</span><span class="o">();</span>
        <span class="nc">ResumeMaker</span> <span class="n">maker</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ResumeMaker</span><span class="o">(</span><span class="n">builder</span><span class="o">);</span>
        <span class="n">maker</span><span class="o">.</span><span class="na">makeCV</span><span class="o">();</span>
        <span class="nc">Resume</span> <span class="n">resume</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="na">build</span><span class="o">();</span>

        <span class="nc">String</span> <span class="n">cvText</span> <span class="o">=</span> <span class="s">"Social NameAndTitle"</span>
                        <span class="o">+</span> <span class="s">"Social Projects"</span>
                        <span class="o">+</span> <span class="s">"Social Testimonials"</span>
                        <span class="o">+</span> <span class="s">"Social Certifications"</span>
                        <span class="o">+</span> <span class="s">"Social Education"</span>
                        <span class="o">+</span> <span class="s">"Social Social"</span>
                        <span class="o">+</span> <span class="s">"Social Personal"</span><span class="o">;</span>

        <span class="n">assertEquals</span><span class="o">(</span><span class="n">cvText</span><span class="o">,</span> <span class="n">resume</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">ensure_social_resume</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">IResumeBuilder</span> <span class="n">builder</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SocialResumeBuilder</span><span class="o">();</span>
        <span class="nc">ResumeMaker</span> <span class="n">maker</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ResumeMaker</span><span class="o">(</span><span class="n">builder</span><span class="o">);</span>
        <span class="n">maker</span><span class="o">.</span><span class="na">makeResume</span><span class="o">();</span>
        <span class="nc">Resume</span> <span class="n">resume</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="na">build</span><span class="o">();</span>

        <span class="nc">String</span> <span class="n">cvText</span> <span class="o">=</span> <span class="s">"Social NameAndTitle"</span>
                        <span class="o">+</span> <span class="s">"Social Projects"</span>
                        <span class="o">+</span> <span class="s">"Social Certifications"</span>
                        <span class="o">+</span> <span class="s">"Social Education"</span>
                        <span class="o">+</span> <span class="s">"Social Personal"</span><span class="o">;</span>

        <span class="n">assertEquals</span><span class="o">(</span><span class="n">cvText</span><span class="o">,</span> <span class="n">resume</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">ensure_social_one_pager</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">IResumeBuilder</span> <span class="n">builder</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SocialResumeBuilder</span><span class="o">();</span>
        <span class="nc">ResumeMaker</span> <span class="n">maker</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ResumeMaker</span><span class="o">(</span><span class="n">builder</span><span class="o">);</span>
        <span class="n">maker</span><span class="o">.</span><span class="na">makeOnePagerResume</span><span class="o">();</span>
        <span class="nc">Resume</span> <span class="n">resume</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="na">build</span><span class="o">();</span>

        <span class="nc">String</span> <span class="n">cvText</span> <span class="o">=</span> <span class="s">"Social NameAndTitle"</span>
                        <span class="o">+</span> <span class="s">"Social Projects"</span>
                        <span class="o">+</span> <span class="s">"Social Personal"</span><span class="o">;</span>

        <span class="n">assertEquals</span><span class="o">(</span><span class="n">cvText</span><span class="o">,</span> <span class="n">resume</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_builder_instances_in_jdk">Builder instances in JDK</h3>
<div class="ulist">
<ul>
<li>
<p>java.lang.StringBuilder#append()</p>
</li>
<li>
<p>java.lang.StringBuffer#append()</p>
</li>
<li>
<p>java.nio.ByteBuffer#put()</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ch06-prototype">Prototype Pattern</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_gof_definition_5">GoF Definition</h3>
<div class="paragraph">
<p>Specify the kinds of objects to create using a prototypical instance, and create new objects by copying this prototype.</p>
</div>
</div>
<div class="sect2">
<h3 id="_uml_representation_8">UML Representation</h3>
<div class="imageblock">
<div class="content">
<img src="images/vocabulary-store.png" alt="vocabulary store" width="532" height="342">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_vocabulary_store_example">Vocabulary Store Example</h3>
<div class="paragraph">
<p></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">IVocabularyStore</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="nf">getWordCount</span><span class="o">();</span>
    <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">getWordList</span><span class="o">();</span>
    <span class="nc">String</span> <span class="nf">getMeaning</span><span class="o">(</span><span class="nc">String</span> <span class="n">word</span><span class="o">);</span>
    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">getUnlearnedWords</span><span class="o">();</span>
    <span class="kt">void</span> <span class="nf">setWordLearned</span><span class="o">(</span><span class="nc">String</span> <span class="n">word</span><span class="o">);</span>
    <span class="kt">void</span> <span class="nf">setWordUnLearned</span><span class="o">(</span><span class="nc">String</span> <span class="n">word</span><span class="o">);</span>
    <span class="nc">IVocabularyStore</span> <span class="nf">getCopy</span><span class="o">();</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">DefaultVocabularyStore</span> <span class="kd">implements</span> <span class="nc">IVocabularyStore</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="n">wordMap</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">DefaultVocabularyStore</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">wordMap</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;&gt;();</span>
        <span class="c1">// expensive word loading operation here</span>
        <span class="k">this</span><span class="o">.</span><span class="na">wordMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"feature"</span><span class="o">,</span> <span class="s">"n. Not an issue"</span><span class="o">);</span>
        <span class="k">this</span><span class="o">.</span><span class="na">wordMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"night"</span><span class="o">,</span> <span class="s">"n. Slogging for the whole night"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="nf">DefaultVocabularyStore</span><span class="o">(</span><span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="n">wordMap</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">wordMap</span> <span class="o">=</span> <span class="n">wordMap</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getWordCount</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">wordMap</span><span class="o">.</span><span class="na">size</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">getWordList</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">wordMap</span><span class="o">.</span><span class="na">keySet</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getMeaning</span><span class="o">(</span><span class="nc">String</span> <span class="n">word</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">wordMap</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">word</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">getUnlearnedWords</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// some logic</span>
        <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setWordLearned</span><span class="o">(</span><span class="nc">String</span> <span class="n">word</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// some logic</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setWordUnLearned</span><span class="o">(</span><span class="nc">String</span> <span class="n">word</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// some logic</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">IVocabularyStore</span> <span class="nf">getCopy</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="n">newWordMap</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;&gt;();</span>
        <span class="k">for</span><span class="o">(</span><span class="nc">Entry</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="n">entry</span> <span class="o">:</span> <span class="n">wordMap</span><span class="o">.</span><span class="na">entrySet</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">newWordMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">entry</span><span class="o">.</span><span class="na">getKey</span><span class="o">(),</span> <span class="n">entry</span><span class="o">.</span><span class="na">getValue</span><span class="o">());</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">DefaultVocabularyStore</span><span class="o">(</span><span class="n">newWordMap</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">VocabularyStoreFactory</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="nc">IVocabularyStore</span> <span class="n">vocabularyStore</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">DefaultVocabularyStore</span><span class="o">();</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">IVocabularyStore</span> <span class="nf">getVocabularyStore</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">vocabularyStore</span><span class="o">.</span><span class="na">getCopy</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">VocabularyStoreFactoryTest</span> <span class="o">{</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">check_stores_are_different</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">IVocabularyStore</span> <span class="n">store1</span> <span class="o">=</span> <span class="nc">VocabularyStoreFactory</span><span class="o">.</span><span class="na">getVocabularyStore</span><span class="o">();</span>
        <span class="nc">IVocabularyStore</span> <span class="n">store2</span> <span class="o">=</span> <span class="nc">VocabularyStoreFactory</span><span class="o">.</span><span class="na">getVocabularyStore</span><span class="o">();</span>
        <span class="n">assertNotEquals</span><span class="o">(</span><span class="n">store1</span><span class="o">,</span> <span class="n">store2</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">check_stores_are_differentcontain_base_words</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">IVocabularyStore</span> <span class="n">store1</span> <span class="o">=</span> <span class="nc">VocabularyStoreFactory</span><span class="o">.</span><span class="na">getVocabularyStore</span><span class="o">();</span>
        <span class="nc">IVocabularyStore</span> <span class="n">store2</span> <span class="o">=</span> <span class="nc">VocabularyStoreFactory</span><span class="o">.</span><span class="na">getVocabularyStore</span><span class="o">();</span>

        <span class="n">assertEquals</span><span class="o">(</span><span class="s">"n. Not an issue"</span><span class="o">,</span> <span class="n">store1</span><span class="o">.</span><span class="na">getMeaning</span><span class="o">(</span><span class="s">"feature"</span><span class="o">));</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="s">"n. Slogging for the whole night"</span><span class="o">,</span> <span class="n">store1</span><span class="o">.</span><span class="na">getMeaning</span><span class="o">(</span><span class="s">"night"</span><span class="o">));</span>

        <span class="n">assertEquals</span><span class="o">(</span><span class="s">"n. Not an issue"</span><span class="o">,</span> <span class="n">store2</span><span class="o">.</span><span class="na">getMeaning</span><span class="o">(</span><span class="s">"feature"</span><span class="o">));</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="s">"n. Slogging for the whole night"</span><span class="o">,</span> <span class="n">store2</span><span class="o">.</span><span class="na">getMeaning</span><span class="o">(</span><span class="s">"night"</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_prototype_instances_in_jdk">Prototype instances in JDK</h3>
<div class="ulist">
<ul>
<li>
<p>Object#clone()</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ch07-adapter">Adapter Pattern</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_gof_definition_6">GoF Definition</h3>
<div class="paragraph">
<p>Convert the interface of a class into another interface that clients expect. Adapter lets classes work together that could not otherwise because of incompatible interfaces.</p>
</div>
</div>
<div class="sect2">
<h3 id="_basic_components_2">Basic Components</h3>
<div class="imageblock">
<div class="content">
<img src="images/adapter-block.png" alt="adapter block" width="237" height="169">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_uml_representation_9">UML Representation</h3>
<div class="imageblock">
<div class="content">
<img src="images/adapter.png" alt="adapter" width="635" height="437">
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Polygon</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getCount</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="mi">0</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">Point</span> <span class="nf">getCoordinate</span><span class="o">(</span><span class="kt">int</span> <span class="n">index</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">VertexCalculator</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">int</span> <span class="nf">countVertices</span><span class="o">(</span><span class="nc">Polygon</span> <span class="n">polygon</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">polygon</span><span class="o">.</span><span class="na">getCount</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Polyline</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Coordinate</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;();</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getCount</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">list</span><span class="o">.</span><span class="na">size</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">Coordinate</span> <span class="nf">getCoordinate</span><span class="o">(</span><span class="kt">int</span> <span class="n">index</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">list</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">index</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">addCoordinate</span><span class="o">(</span><span class="nc">Coordinate</span> <span class="n">coordinate</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">coordinate</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">PolygonAdapter</span> <span class="kd">extends</span> <span class="nc">Polygon</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">Polyline</span> <span class="n">polyline</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">PolygonAdapter</span><span class="o">(</span><span class="nc">Polyline</span> <span class="n">polyline</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">polyline</span> <span class="o">=</span> <span class="n">polyline</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getCount</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">polyline</span><span class="o">.</span><span class="na">getCount</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">Point</span> <span class="nf">getCoordinate</span><span class="o">(</span><span class="kt">int</span> <span class="n">index</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Coordinate</span> <span class="n">coordinate</span> <span class="o">=</span> <span class="n">polyline</span><span class="o">.</span><span class="na">getCoordinate</span><span class="o">(</span><span class="n">index</span><span class="o">);</span>
        <span class="nc">Point</span> <span class="n">point</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Point</span><span class="o">();</span>
        <span class="n">point</span><span class="o">.</span><span class="na">setX</span><span class="o">(</span><span class="n">coordinate</span><span class="o">.</span><span class="na">getLongitude</span><span class="o">());</span>
        <span class="n">point</span><span class="o">.</span><span class="na">setY</span><span class="o">(</span><span class="n">coordinate</span><span class="o">.</span><span class="na">getLatitude</span><span class="o">());</span>
        <span class="k">return</span> <span class="n">point</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Application</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">Polyline</span> <span class="n">polyline</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Application</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">polyline</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Polyline</span><span class="o">();</span>
        <span class="n">polyline</span><span class="o">.</span><span class="na">addCoordinate</span><span class="o">(</span><span class="k">new</span> <span class="nc">Coordinate</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span><span class="mi">2</span><span class="o">));</span>
        <span class="n">polyline</span><span class="o">.</span><span class="na">addCoordinate</span><span class="o">(</span><span class="k">new</span> <span class="nc">Coordinate</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span><span class="mi">5</span><span class="o">));</span>
        <span class="n">polyline</span><span class="o">.</span><span class="na">addCoordinate</span><span class="o">(</span><span class="k">new</span> <span class="nc">Coordinate</span><span class="o">(</span><span class="mi">7</span><span class="o">,</span><span class="mi">4</span><span class="o">));</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">calculateCornerCount</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nc">VertexCalculator</span><span class="o">.</span><span class="na">countVertices</span><span class="o">(</span><span class="k">new</span> <span class="nc">PolygonAdapter</span><span class="o">(</span><span class="n">polyline</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">ApplicationTest</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="nc">Application</span> <span class="n">target</span><span class="o">;</span>

    <span class="nd">@BeforeEach</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">beforeEach</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">target</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Application</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">check_object_is_same</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="n">target</span><span class="o">.</span><span class="na">calculateCornerCount</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_adapter_instances_in_jdk">Adapter instances in JDK</h3>
<div class="ulist">
<ul>
<li>
<p>java.util.Arrays#asList()</p>
</li>
<li>
<p>java.util.Collections#list()</p>
</li>
<li>
<p>java.util.Collections#enumeration()</p>
</li>
<li>
<p>java.io.InputStreamReader(InputStream) (returns a Reader)</p>
</li>
<li>
<p>java.io.OutputStreamWriter(OutputStream) (returns a Writer)</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ch08-bridge">Bridge Pattern</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_gof_definition_7">GoF Definition</h3>
<div class="paragraph">
<p>Decouple an abstraction from its implementation so that the two can vary independently.</p>
</div>
</div>
<div class="sect2">
<h3 id="_basic_concept">Basic Concept</h3>
<div class="paragraph">
<p>Inheritance is a common way to specify different implementations of an abstraction. Using inheritance the implementations are  bound tightly to the abstraction,and it is difficult to modify them independently. The Bridge pattern provides an alternative to inheritance when there is more than one version of an abstraction.</p>
</div>
</div>
<div class="sect2">
<h3 id="_components">Components</h3>
<div class="imageblock">
<div class="content">
<img src="images/bridge-components.png" alt="bridge components" width="462" height="433">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_inheritance_example">Inheritance Example</h3>
<div class="imageblock">
<div class="content">
<img src="images/inheritance-bridge.png" alt="inheritance bridge" width="721" height="401">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_bridge_example">Bridge Example</h3>
<div class="imageblock">
<div class="content">
<img src="images/bridge-example.png" alt="bridge example" width="769" height="293">
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">IMessageSender</span> <span class="o">{</span>
    <span class="nc">String</span> <span class="nf">sendMessage</span><span class="o">(</span><span class="nc">String</span> <span class="n">message</span><span class="o">);</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">IMessageFormatter</span> <span class="o">{</span>
    <span class="nc">String</span> <span class="nf">formatMessage</span><span class="o">(</span><span class="nc">String</span> <span class="n">message</span><span class="o">);</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MessageSender</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">IMessageSender</span> <span class="n">sender</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">IMessageFormatter</span> <span class="n">formatter</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">MessageSender</span><span class="o">(</span><span class="nc">IMessageSender</span> <span class="n">sender</span><span class="o">,</span> <span class="nc">IMessageFormatter</span> <span class="n">formatter</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">sender</span> <span class="o">=</span> <span class="n">sender</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">formatter</span> <span class="o">=</span> <span class="n">formatter</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">post</span><span class="o">(</span><span class="nc">String</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">String</span> <span class="n">formattedMessage</span> <span class="o">=</span> <span class="n">formatter</span><span class="o">.</span><span class="na">formatMessage</span><span class="o">(</span><span class="n">message</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">sender</span><span class="o">.</span><span class="na">sendMessage</span><span class="o">(</span><span class="n">formattedMessage</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">TextFormatter</span> <span class="kd">implements</span> <span class="nc">IMessageFormatter</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">formatMessage</span><span class="o">(</span><span class="nc">String</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">"Text Message: "</span> <span class="o">+</span> <span class="n">message</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">HTMLFormatter</span> <span class="kd">implements</span> <span class="nc">IMessageFormatter</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">formatMessage</span><span class="o">(</span><span class="nc">String</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">"HTML Message: "</span> <span class="o">+</span> <span class="n">message</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SMSSender</span> <span class="kd">implements</span> <span class="nc">IMessageSender</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">sendMessage</span><span class="o">(</span><span class="nc">String</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">"SMS : "</span> <span class="o">+</span> <span class="n">message</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">EmailSender</span> <span class="kd">implements</span> <span class="nc">IMessageSender</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">sendMessage</span><span class="o">(</span><span class="nc">String</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">"Email : "</span> <span class="o">+</span> <span class="n">message</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">MessageSenderTest</span> <span class="o">{</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">check_sms_text_sender</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">IMessageFormatter</span> <span class="n">formatter</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">TextFormatter</span><span class="o">();</span>
        <span class="nc">IMessageSender</span> <span class="n">sender</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SMSSender</span><span class="o">();</span>
        <span class="nc">MessageSender</span> <span class="n">messageSender</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">MessageSender</span><span class="o">(</span><span class="n">sender</span><span class="o">,</span> <span class="n">formatter</span><span class="o">);</span>
        <span class="nc">String</span> <span class="n">message</span> <span class="o">=</span> <span class="n">messageSender</span><span class="o">.</span><span class="na">post</span><span class="o">(</span><span class="s">"Message"</span><span class="o">);</span>

        <span class="n">assertEquals</span><span class="o">(</span><span class="s">"SMS : Text Message: Message"</span><span class="o">,</span> <span class="n">message</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">check_sms_html_sender</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">IMessageFormatter</span> <span class="n">formatter</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HTMLFormatter</span><span class="o">();</span>
        <span class="nc">IMessageSender</span> <span class="n">sender</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SMSSender</span><span class="o">();</span>
        <span class="nc">MessageSender</span> <span class="n">messageSender</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">MessageSender</span><span class="o">(</span><span class="n">sender</span><span class="o">,</span> <span class="n">formatter</span><span class="o">);</span>
        <span class="nc">String</span> <span class="n">message</span> <span class="o">=</span> <span class="n">messageSender</span><span class="o">.</span><span class="na">post</span><span class="o">(</span><span class="s">"Message"</span><span class="o">);</span>

        <span class="n">assertEquals</span><span class="o">(</span><span class="s">"SMS : HTML Message: Message"</span><span class="o">,</span> <span class="n">message</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">check_email_text_sender</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">IMessageFormatter</span> <span class="n">formatter</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">TextFormatter</span><span class="o">();</span>
        <span class="nc">IMessageSender</span> <span class="n">sender</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">EmailSender</span><span class="o">();</span>
        <span class="nc">MessageSender</span> <span class="n">messageSender</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">MessageSender</span><span class="o">(</span><span class="n">sender</span><span class="o">,</span> <span class="n">formatter</span><span class="o">);</span>
        <span class="nc">String</span> <span class="n">message</span> <span class="o">=</span> <span class="n">messageSender</span><span class="o">.</span><span class="na">post</span><span class="o">(</span><span class="s">"Message"</span><span class="o">);</span>

        <span class="n">assertEquals</span><span class="o">(</span><span class="s">"Email : Text Message: Message"</span><span class="o">,</span> <span class="n">message</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">check_email_html_sender</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">IMessageFormatter</span> <span class="n">formatter</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HTMLFormatter</span><span class="o">();</span>
        <span class="nc">IMessageSender</span> <span class="n">sender</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">EmailSender</span><span class="o">();</span>
        <span class="nc">MessageSender</span> <span class="n">messageSender</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">MessageSender</span><span class="o">(</span><span class="n">sender</span><span class="o">,</span> <span class="n">formatter</span><span class="o">);</span>
        <span class="nc">String</span> <span class="n">message</span> <span class="o">=</span> <span class="n">messageSender</span><span class="o">.</span><span class="na">post</span><span class="o">(</span><span class="s">"Message"</span><span class="o">);</span>

        <span class="n">assertEquals</span><span class="o">(</span><span class="s">"Email : HTML Message: Message"</span><span class="o">,</span> <span class="n">message</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ch09-proxy">Proxy Pattern</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_gof_definition_8">GoF Definition</h3>
<div class="paragraph">
<p>Provide a surrogate or placeholder for another object to control access to it.</p>
</div>
</div>
<div class="sect2">
<h3 id="_basic_components_3">Basic Components</h3>
<div class="imageblock">
<div class="content">
<img src="images/proxy-components.png" alt="proxy components" width="250" height="401">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_remote_proxies">Remote Proxies</h3>
<div class="paragraph">
<p>Remote Proxies provide a local representation of another remote object or resource. Remote proxies are responsible not just for representation but also for some maintenance work. Such work could include connecting to a remote machine and maintaining the connection, encoding and decoding characters obtained through networking traffic, parsing, etc.</p>
</div>
</div>
<div class="sect2">
<h3 id="_virtual_proxies">Virtual Proxies</h3>
<div class="paragraph">
<p>Virtual Proxies wrap expensive objects and loads them on-demand. Sometimes we don&#8217;t immediately need all functionalities that an object offers, especially if it is memory/time-consuming. Calling objects only when needed might increase performance quite a bit, as we&#8217;ll see in the example below.</p>
</div>
</div>
<div class="sect2">
<h3 id="_protection_proxies">Protection Proxies</h3>
<div class="paragraph">
<p>Protection Proxies are used for checking certain conditions. Some objects or resources might need appropriate authorization for accessing them, so using a proxy is one of the ways in which such conditions can be checked. With protection proxies, we also get the flexibility of having many variations of access control.</p>
</div>
</div>
<div class="sect2">
<h3 id="_proxy_instances_in_jdk">Proxy instances in JDK</h3>
<div class="ulist">
<ul>
<li>
<p>java.lang.reflect.Proxy</p>
</li>
<li>
<p>java.rmi.*</p>
</li>
<li>
<p>javax.ejb.EJB (Proxies injected by framworks)</p>
</li>
<li>
<p>javax.inject.Inject (Proxies injected by frameworks)</p>
</li>
<li>
<p>javax.persistence.PersistenceContext</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ch10-composite">Composite Pattern</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_gof_definition_9">GoF Definition</h3>
<div class="paragraph">
<p>Compose objects into tree structures to represent part-whole hierarchies. Com- posite lets clients treat individual objects and compositions of objects uniformly.</p>
</div>
</div>
<div class="sect2">
<h3 id="_basic_components_4">Basic Components</h3>
<div class="imageblock">
<div class="content">
<img src="images/composite-components.png" alt="composite components" width="451" height="234">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_uml_representation_10">UML Representation</h3>
<div class="imageblock">
<div class="content">
<img src="images/html-element-composite.png" alt="html element composite" width="535" height="218">
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">HTMLElement</span> <span class="o">{</span>
    <span class="nc">String</span> <span class="n">tagName</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">HTMLElement</span><span class="o">&gt;</span> <span class="n">children</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;();</span>

    <span class="kd">public</span> <span class="nf">HTMLElement</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">(</span><span class="s">"html"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nf">HTMLElement</span><span class="o">(</span><span class="nc">String</span> <span class="n">tagName</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">tagName</span> <span class="o">=</span> <span class="n">tagName</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">add</span><span class="o">(</span><span class="nc">HTMLElement</span> <span class="n">element</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">children</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">element</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">StringBuilder</span> <span class="n">builder</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">StringBuilder</span><span class="o">();</span>
        <span class="n">builder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">"&lt;"</span><span class="o">);</span>
        <span class="n">builder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">tagName</span><span class="o">);</span>
        <span class="n">builder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">"&gt;"</span><span class="o">);</span>
        <span class="k">for</span><span class="o">(</span><span class="nc">HTMLElement</span> <span class="n">element</span> <span class="o">:</span> <span class="n">children</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">builder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">element</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
        <span class="o">}</span>
        <span class="n">builder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">"&lt;/"</span><span class="o">);</span>
        <span class="n">builder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">tagName</span><span class="o">);</span>
        <span class="n">builder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">"&gt;"</span><span class="o">);</span>

        <span class="k">return</span> <span class="n">builder</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">BodyElement</span> <span class="kd">extends</span> <span class="nc">HTMLElement</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">BodyElement</span><span class="o">()</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">(</span><span class="s">"body"</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">PElement</span> <span class="kd">extends</span> <span class="nc">HTMLElement</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">PElement</span><span class="o">()</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">(</span><span class="s">"p"</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">TextElement</span> <span class="kd">extends</span> <span class="nc">HTMLElement</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">TextElement</span><span class="o">(</span><span class="nc">String</span> <span class="n">text</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">(</span><span class="n">text</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">tagName</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">HTMLElementTest</span> <span class="o">{</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">test_html_element</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">HTMLElement</span> <span class="n">htmlElement</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HTMLElement</span><span class="o">();</span>
        <span class="nc">BodyElement</span> <span class="n">body</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BodyElement</span><span class="o">();</span>
        <span class="n">htmlElement</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">body</span><span class="o">);</span>
        <span class="nc">PElement</span> <span class="n">p</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">PElement</span><span class="o">();</span>
        <span class="n">body</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">p</span><span class="o">);</span>
        <span class="nc">TextElement</span> <span class="n">text</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">TextElement</span><span class="o">(</span><span class="s">"Hello World!"</span><span class="o">);</span>
        <span class="n">p</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">text</span><span class="o">);</span>

        <span class="nc">String</span> <span class="n">expectedText</span> <span class="o">=</span> <span class="s">"&lt;html&gt;"</span>
                                <span class="o">+</span> <span class="s">"&lt;body&gt;&lt;p&gt;Hello World!&lt;/p&gt;&lt;/body&gt;"</span>
                                <span class="o">+</span> <span class="s">"&lt;/html&gt;"</span><span class="o">;</span>

        <span class="n">assertEquals</span><span class="o">(</span><span class="n">expectedText</span><span class="o">,</span> <span class="n">htmlElement</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_proxy_instances_in_jdk_2">Proxy instances in JDK</h3>
<div class="ulist">
<ul>
<li>
<p>java.awt.Container#add(Component)</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ch11-decorator">Decorator Pattern</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_gof_definition_10">GoF Definition</h3>
<div class="paragraph">
<p>Attach additional responsibilities to an object dynamically. Decorators provide a flexible alternative to subclassing for extending functionality.</p>
</div>
</div>
<div class="sect2">
<h3 id="_basic_components_5">Basic Components</h3>
<div class="imageblock">
<div class="content">
<img src="images/decorator-components.png" alt="decorator components" width="322" height="374">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_uml_representation_11">UML Representation</h3>
<div class="imageblock">
<div class="content">
<img src="images/decorator-logger.png" alt="decorator logger" width="263" height="401">
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">ILogger</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">log</span><span class="o">(</span><span class="nc">String</span> <span class="n">message</span><span class="o">);</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Logger</span> <span class="kd">implements</span> <span class="nc">ILogger</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">log</span><span class="o">(</span><span class="nc">String</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">message</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">User</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">User</span><span class="o">(</span><span class="nc">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getName</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">name</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">LoggerWrapper</span> <span class="kd">implements</span> <span class="nc">ILogger</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">User</span> <span class="n">user</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">ILogger</span> <span class="n">logger</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">LoggerWrapper</span><span class="o">(</span><span class="nc">ILogger</span> <span class="n">logger</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">(</span><span class="n">logger</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nf">LoggerWrapper</span><span class="o">(</span><span class="nc">ILogger</span> <span class="n">logger</span><span class="o">,</span> <span class="nc">User</span> <span class="n">user</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">logger</span> <span class="o">=</span> <span class="n">logger</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">user</span> <span class="o">=</span> <span class="n">user</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">log</span><span class="o">(</span><span class="nc">User</span> <span class="n">user</span><span class="o">,</span> <span class="nc">String</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">logger</span><span class="o">.</span><span class="na">log</span><span class="o">(</span><span class="s">"Called by "</span> <span class="o">+</span> <span class="n">user</span><span class="o">.</span><span class="na">getName</span><span class="o">()</span> <span class="o">+</span> <span class="s">" - "</span> <span class="o">+</span> <span class="n">message</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">log</span><span class="o">(</span><span class="nc">String</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span><span class="o">(</span> <span class="n">user</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">logger</span><span class="o">.</span><span class="na">log</span><span class="o">(</span><span class="s">"Called by "</span> <span class="o">+</span> <span class="n">user</span><span class="o">.</span><span class="na">getName</span><span class="o">()</span> <span class="o">+</span> <span class="s">" - "</span> <span class="o">+</span> <span class="n">message</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">logger</span><span class="o">.</span><span class="na">log</span><span class="o">(</span><span class="n">message</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">LoggerWrapperTest</span> <span class="o">{</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">test_no_user</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">ILogger</span> <span class="n">realLogger</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Logger</span><span class="o">();</span>
        <span class="nc">ILogger</span> <span class="n">logger</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">LoggerWrapper</span><span class="o">(</span><span class="n">realLogger</span><span class="o">);</span>

        <span class="nc">String</span> <span class="n">value</span> <span class="o">=</span> <span class="n">logger</span><span class="o">.</span><span class="na">log</span><span class="o">(</span><span class="s">"Some Message"</span><span class="o">);</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="s">"Some Message"</span><span class="o">,</span> <span class="n">value</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">test_user_passed_in_constructor</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">Logger</span> <span class="n">realLogger</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Logger</span><span class="o">();</span>
        <span class="nc">User</span> <span class="n">user</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">User</span><span class="o">(</span><span class="s">"Tushar"</span><span class="o">);</span>
        <span class="nc">ILogger</span> <span class="n">logger</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">LoggerWrapper</span><span class="o">(</span><span class="n">realLogger</span><span class="o">,</span> <span class="n">user</span><span class="o">);</span>

        <span class="nc">String</span> <span class="n">value</span> <span class="o">=</span> <span class="n">logger</span><span class="o">.</span><span class="na">log</span><span class="o">(</span><span class="s">"Some Message"</span><span class="o">);</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="s">"Called by Tushar - Some Message"</span><span class="o">,</span> <span class="n">value</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_convenience_wrappers">Convenience Wrappers</h3>
<div class="paragraph">
<p>Decorator or Wrapper classes can be written for writing convenience methods over existing API services and libraries.  The operations needed in combination from the third party library can be created as an additional method of the wrapper.</p>
</div>
</div>
<div class="sect2">
<h3 id="_anti_corruption_layer">Anti Corruption Layer</h3>
<div class="paragraph">
<p>Wrapper classes can be written to abstract the third party service so it can be swapped with another service without impacting the rest of the project, as rest of the project only depends on the wrapper interface</p>
</div>
</div>
<div class="sect2">
<h3 id="_uml_representation_12">UML Representation</h3>
<div class="imageblock">
<div class="content">
<img src="images/decorator-anti-corruption.png" alt="decorator anti corruption" width="412" height="293">
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">LoggerV2</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">logMessage</span><span class="o">(</span><span class="nc">String</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">message</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">LoggerWrapper</span> <span class="kd">implements</span> <span class="nc">ILogger</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">User</span> <span class="n">user</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">LoggerV2</span> <span class="n">logger</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">LoggerWrapper</span><span class="o">(</span><span class="nc">LoggerV2</span> <span class="n">logger</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">(</span><span class="n">logger</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nf">LoggerWrapper</span><span class="o">(</span><span class="nc">LoggerV2</span> <span class="n">logger</span><span class="o">,</span> <span class="nc">User</span> <span class="n">user</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">logger</span> <span class="o">=</span> <span class="n">logger</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">user</span> <span class="o">=</span> <span class="n">user</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">log</span><span class="o">(</span><span class="nc">User</span> <span class="n">user</span><span class="o">,</span> <span class="nc">String</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">logger</span><span class="o">.</span><span class="na">logMessage</span><span class="o">(</span><span class="s">"Called by "</span> <span class="o">+</span> <span class="n">user</span><span class="o">.</span><span class="na">getName</span><span class="o">()</span> <span class="o">+</span> <span class="s">" - "</span> <span class="o">+</span> <span class="n">message</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">log</span><span class="o">(</span><span class="nc">String</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span><span class="o">(</span> <span class="n">user</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">logger</span><span class="o">.</span><span class="na">logMessage</span><span class="o">(</span><span class="s">"Called by "</span> <span class="o">+</span> <span class="n">user</span><span class="o">.</span><span class="na">getName</span><span class="o">()</span> <span class="o">+</span> <span class="s">" - "</span> <span class="o">+</span> <span class="n">message</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">logger</span><span class="o">.</span><span class="na">logMessage</span><span class="o">(</span><span class="n">message</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">LoggerWrapperTest</span> <span class="o">{</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">test_no_user</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">LoggerV2</span> <span class="n">realLogger</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">LoggerV2</span><span class="o">();</span>
        <span class="nc">ILogger</span> <span class="n">logger</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">LoggerWrapper</span><span class="o">(</span><span class="n">realLogger</span><span class="o">);</span>

        <span class="nc">String</span> <span class="n">value</span> <span class="o">=</span> <span class="n">logger</span><span class="o">.</span><span class="na">log</span><span class="o">(</span><span class="s">"Some Message"</span><span class="o">);</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="s">"Some Message"</span><span class="o">,</span> <span class="n">value</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">test_user_passed_in_constructor</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">LoggerV2</span> <span class="n">realLogger</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Logger</span><span class="o">();</span>
        <span class="nc">User</span> <span class="n">user</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">User</span><span class="o">(</span><span class="s">"Tushar"</span><span class="o">);</span>
        <span class="nc">ILogger</span> <span class="n">logger</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">LoggerWrapper</span><span class="o">(</span><span class="n">realLogger</span><span class="o">,</span> <span class="n">user</span><span class="o">);</span>

        <span class="nc">String</span> <span class="n">value</span> <span class="o">=</span> <span class="n">logger</span><span class="o">.</span><span class="na">log</span><span class="o">(</span><span class="s">"Some Message"</span><span class="o">);</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="s">"Called by Tushar - Some Message"</span><span class="o">,</span> <span class="n">value</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_decorator_instances_in_jdk">Decorator instances in JDK</h3>
<div class="ulist">
<ul>
<li>
<p>java.io.InputStream</p>
</li>
<li>
<p>java.io.InputStreamReader</p>
</li>
<li>
<p>java.io.BufferedReader</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ch12-facade">Facade Pattern</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_gof_definition_11">GoF Definition</h3>
<div class="paragraph">
<p>Provide a unified interface to a set of interfaces in a subsystem. Facade defines a higher-level interface that makes the subsystem easier to use.</p>
</div>
</div>
<div class="sect2">
<h3 id="_basic_components_6">Basic Components</h3>
<div class="imageblock">
<div class="content">
<img src="images/facade-components.png" alt="facade components" width="274" height="325">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_uml_representation_13">UML Representation</h3>
<div class="imageblock">
<div class="content">
<img src="images/facade-markup.png" alt="facade markup" width="717" height="344">
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Markup</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">createMarkup</span><span class="o">(</span><span class="nc">String</span> <span class="n">text</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">HTMLElement</span> <span class="n">html</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HTMLElement</span><span class="o">();</span>
        <span class="nc">BodyElement</span> <span class="n">body</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BodyElement</span><span class="o">();</span>
        <span class="nc">PElement</span> <span class="n">p</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">PElement</span><span class="o">();</span>
        <span class="nc">TextElement</span> <span class="n">textElement</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">TextElement</span><span class="o">(</span><span class="n">text</span><span class="o">);</span>
        <span class="n">html</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">body</span><span class="o">);</span>
        <span class="n">body</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">p</span><span class="o">);</span>
        <span class="n">p</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">textElement</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">html</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">MarkupTest</span> <span class="o">{</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">test_markup</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">Markup</span> <span class="n">markup</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Markup</span><span class="o">();</span>
        <span class="nc">String</span> <span class="n">markupText</span><span class="o">=</span> <span class="n">markup</span><span class="o">.</span><span class="na">createMarkup</span><span class="o">(</span><span class="s">"Hello World!"</span><span class="o">);</span>

        <span class="nc">String</span> <span class="n">expectedText</span> <span class="o">=</span> <span class="s">"&lt;html&gt;"</span>
                                <span class="o">+</span> <span class="s">"&lt;body&gt;&lt;p&gt;Hello World!&lt;/p&gt;&lt;/body&gt;"</span>
                                <span class="o">+</span> <span class="s">"&lt;/html&gt;"</span><span class="o">;</span>

        <span class="n">assertEquals</span><span class="o">(</span><span class="n">expectedText</span><span class="o">,</span> <span class="n">markupText</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ch13-flyweight">Flyweight Pattern</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_gof_definition_12">GoF Definition</h3>
<div class="paragraph">
<p>Use sharing to support large numbers of fine-grained objects efficiently.</p>
</div>
</div>
<div class="sect2">
<h3 id="_basic_components_7">Basic Components</h3>
<div class="imageblock">
<div class="content">
<img src="images/flyweight-components.png" alt="flyweight components" width="345" height="293">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_uml_representation_14">UML Representation</h3>
<div class="imageblock">
<div class="content">
<img src="images/flyweight-format.png" alt="flyweight format" width="373" height="293">
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Format</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">fontSize</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">color</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Format</span><span class="o">(</span><span class="nc">String</span> <span class="n">color</span><span class="o">,</span> <span class="kt">int</span> <span class="n">fontSize</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">color</span> <span class="o">=</span> <span class="n">color</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">fontSize</span> <span class="o">=</span> <span class="n">fontSize</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getFontSize</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">fontSize</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getColor</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">color</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">FormatFactory</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Format</span><span class="o">&gt;</span> <span class="n">formatMap</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;&gt;();</span>

    <span class="kd">private</span> <span class="nc">String</span> <span class="nf">getKey</span><span class="o">(</span><span class="nc">String</span> <span class="n">color</span><span class="o">,</span> <span class="kt">int</span> <span class="n">fontSize</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">color</span> <span class="o">+</span> <span class="n">fontSize</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getCount</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">formatMap</span><span class="o">.</span><span class="na">size</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">Format</span> <span class="nf">getFormat</span><span class="o">(</span><span class="nc">String</span> <span class="n">color</span><span class="o">,</span> <span class="kt">int</span> <span class="n">fontSize</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">String</span> <span class="n">key</span> <span class="o">=</span> <span class="n">getKey</span><span class="o">(</span><span class="n">color</span><span class="o">,</span> <span class="n">fontSize</span><span class="o">);</span>
        <span class="nc">Format</span> <span class="n">format</span> <span class="o">=</span> <span class="n">formatMap</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">key</span><span class="o">);</span>
        <span class="k">if</span><span class="o">(</span> <span class="n">format</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">)</span> <span class="o">{</span>
            <span class="n">format</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Format</span><span class="o">(</span><span class="n">color</span><span class="o">,</span> <span class="n">fontSize</span><span class="o">);</span>
            <span class="n">formatMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">format</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">format</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">FormatFactoryTest</span> <span class="o">{</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">test_required_objects_created_only</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Format</span><span class="o">&gt;</span> <span class="n">formatList</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;();</span>
        <span class="nc">FormatFactory</span> <span class="n">formatFactory</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">FormatFactory</span><span class="o">();</span>

        <span class="n">formatList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">formatFactory</span><span class="o">.</span><span class="na">getFormat</span><span class="o">(</span><span class="s">"Blue"</span><span class="o">,</span> <span class="mi">20</span><span class="o">));</span> <span class="c1">// 1</span>
        <span class="n">formatList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">formatFactory</span><span class="o">.</span><span class="na">getFormat</span><span class="o">(</span><span class="s">"Blue"</span><span class="o">,</span> <span class="mi">20</span><span class="o">));</span>
        <span class="n">formatList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">formatFactory</span><span class="o">.</span><span class="na">getFormat</span><span class="o">(</span><span class="s">"Blue"</span><span class="o">,</span> <span class="mi">20</span><span class="o">));</span>
        <span class="n">formatList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">formatFactory</span><span class="o">.</span><span class="na">getFormat</span><span class="o">(</span><span class="s">"White"</span><span class="o">,</span> <span class="mi">10</span><span class="o">));</span> <span class="c1">// 2</span>
        <span class="n">formatList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">formatFactory</span><span class="o">.</span><span class="na">getFormat</span><span class="o">(</span><span class="s">"White"</span><span class="o">,</span> <span class="mi">10</span><span class="o">));</span>
        <span class="n">formatList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">formatFactory</span><span class="o">.</span><span class="na">getFormat</span><span class="o">(</span><span class="s">"White"</span><span class="o">,</span> <span class="mi">30</span><span class="o">));</span> <span class="c1">// 3</span>
        <span class="n">formatList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">formatFactory</span><span class="o">.</span><span class="na">getFormat</span><span class="o">(</span><span class="s">"Red"</span><span class="o">,</span> <span class="mi">24</span><span class="o">));</span> <span class="c1">// 4</span>
        <span class="n">formatList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">formatFactory</span><span class="o">.</span><span class="na">getFormat</span><span class="o">(</span><span class="s">"Red"</span><span class="o">,</span> <span class="mi">24</span><span class="o">));</span>
        <span class="n">formatList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">formatFactory</span><span class="o">.</span><span class="na">getFormat</span><span class="o">(</span><span class="s">"Red"</span><span class="o">,</span> <span class="mi">24</span><span class="o">));</span>
        <span class="n">formatList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">formatFactory</span><span class="o">.</span><span class="na">getFormat</span><span class="o">(</span><span class="s">"Red"</span><span class="o">,</span> <span class="mi">32</span><span class="o">));</span> <span class="c1">// 5</span>

        <span class="n">assertEquals</span><span class="o">(</span><span class="mi">5</span><span class="o">,</span> <span class="n">formatFactory</span><span class="o">.</span><span class="na">getCount</span><span class="o">());</span>
    <span class="o">}</span>

<span class="o">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_references_in_jdk">References in JDK</h3>
<div class="ulist">
<ul>
<li>
<p>java.lang.Integer#valueOf(int) (also Boolean, Byte, Character, Short, Long and BigDecimal)</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ch14-memento">Memento Pattern</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_gof_definition_13">GoF Definition</h3>
<div class="paragraph">
<p>Without violating encapsulation, capture and externalize an object&#8217;s internal state so that the object can be restored to this state later.</p>
</div>
</div>
<div class="sect2">
<h3 id="_basic_components_8">Basic Components</h3>
<div class="imageblock">
<div class="content">
<img src="images/memento-components.png" alt="memento components" width="448" height="201">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_uml_representation_15">UML Representation</h3>
<div class="imageblock">
<div class="content">
<img src="images/memento-example.png" alt="memento example" width="728" height="293">
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ch15-iterator">Iterator Pattern</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_gof_definition_14">GoF Definition</h3>
<div class="paragraph">
<p>Provide a way to access the elements of an aggregate object sequentially without exposing its underlying representation.
(Also known as Cursor)</p>
</div>
</div>
<div class="sect2">
<h3 id="_basic_components_9">Basic Components</h3>
<div class="imageblock">
<div class="content">
<img src="images/iterator-components.png" alt="iterator components" width="286" height="450">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_uml_representation_16">UML Representation</h3>
<div class="imageblock">
<div class="content">
<img src="images/iterator-example.png" alt="iterator example" width="552" height="436">
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ch16-observer">Observer Pattern</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_gof_definition_15">GoF Definition</h3>
<div class="paragraph">
<p>Define a one-to-many dependency between objects so that when one object changes state, all its dependents are notified and updated automatically.</p>
</div>
</div>
<div class="sect2">
<h3 id="_basic_components_10">Basic Components</h3>
<div class="imageblock">
<div class="content">
<img src="images/observer-components.png" alt="observer components" width="468" height="342">
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ch17-interpreter">Interpreter Pattern</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_gof_definition_16">GoF Definition</h3>
<div class="paragraph">
<p>Given a language, define a representation for its grammar along with an interpreter that uses the representation to interpret sentences in the language.</p>
</div>
</div>
<div class="sect2">
<h3 id="_basic_components_11">Basic Components</h3>
<div class="imageblock">
<div class="content">
<img src="images/interpeter-components.png" alt="interpeter components" width="566" height="293">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_custom_dsl_and_evaluation">Custom DSL and Evaluation</h3>
<div class="paragraph">
<p>For this example we consider a custom DSL for creating expressions which could be evaluated.
The DSL will have elements separated by space, which will help us tokenize the expression quickly.</p>
</div>
<div class="paragraph">
<p>Operators we will recognize</p>
</div>
<div class="ulist">
<ul>
<li>
<p>plus - for addition</p>
</li>
<li>
<p>minus - for subtraction</p>
</li>
<li>
<p>times - for multiplication</p>
</li>
<li>
<p>by - for division</p>
</li>
<li>
<p>( - for open parenthesis</p>
</li>
<li>
<p>) - for closed parenthesis</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>All other characters will be considered as either variables or numbers.
If the character sequence could be parsed into a number it will be assumed as number.
If the character sequence is not parseable as number it will be considered as a variable.
The value of variable will be fetched from the context later while interpreting time.</p>
</div>
<div class="openblock">
<div class="title">Example Expression</div>
<div class="content">
<div class="paragraph">
<p>2 plus ( 9 minus 2 ) times 10</p>
</div>
</div>
</div>
<div class="paragraph">
<p>This expression shall be converted into Abstract Syntax Tree (AST) so the root of the tree can be called.
The root of the tree when called with interprete method will delegate the inpretation to all child elements.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/expression-map.png" alt="expression map" width="516" height="175">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/expression-classes.png" alt="expression classes" width="1098" height="574">
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ch18-mediator">Mediator Pattern</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_gof_definition_17">GoF Definition</h3>
<div class="paragraph">
<p>Define an object that encapsulates how a set of objects interact. Mediator promotes loose coupling by keeping objects from referring to each other explicitly, and it lets you vary their interaction independently.</p>
</div>
<div class="sect3">
<h4 id="_basic_components_12">Basic Components</h4>
<div class="imageblock">
<div class="content">
<img src="images/mediator-components.png" alt="mediator components" width="524" height="277">
</div>
</div>
</div>
<div class="sect3">
<h4 id="_uml_representation_17">UML representation</h4>
<div class="imageblock">
<div class="content">
<img src="images/mediator-calculator.png" alt="mediator calculator" width="210" height="169">
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Display</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">text</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">Calculator</span> <span class="n">calculator</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Display</span><span class="o">(</span><span class="nc">Calculator</span> <span class="n">calculator</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">calculator</span> <span class="o">=</span> <span class="n">calculator</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getText</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">text</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setText</span><span class="o">(</span><span class="nc">String</span> <span class="n">text</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">click</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">calculator</span><span class="o">.</span><span class="na">onClick</span><span class="o">(</span><span class="s">"display"</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Button</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">title</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">Calculator</span> <span class="n">calculator</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Button</span><span class="o">(</span><span class="nc">Calculator</span> <span class="n">calculator</span><span class="o">,</span> <span class="nc">String</span> <span class="n">title</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">calculator</span> <span class="o">=</span> <span class="n">calculator</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">title</span> <span class="o">=</span> <span class="n">title</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">click</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">calculator</span><span class="o">.</span><span class="na">onClick</span><span class="o">(</span><span class="n">title</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Calculator</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">Display</span> <span class="n">display</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">Button</span> <span class="n">one</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">Button</span> <span class="n">zero</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">Button</span> <span class="n">plus</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">Button</span> <span class="n">minus</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">Button</span> <span class="n">equalTo</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">previousNumberText</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">currentNumberText</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">operator</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Calculator</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">display</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Display</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
        <span class="n">one</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Button</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="s">"1"</span><span class="o">);</span>
        <span class="n">zero</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Button</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="s">"0"</span><span class="o">);</span>
        <span class="n">plus</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Button</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="s">"plus"</span><span class="o">);</span>
        <span class="n">minus</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Button</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="s">"minus"</span><span class="o">);</span>
        <span class="n">equalTo</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Button</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="s">"="</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">Button</span> <span class="nf">getOne</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">one</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">Button</span> <span class="nf">getZero</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">zero</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">Button</span> <span class="nf">getPlus</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">plus</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">Button</span> <span class="nf">getMinus</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">minus</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">Button</span> <span class="nf">getEqualTo</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">equalTo</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">Display</span> <span class="nf">getDisplay</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">display</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onClick</span><span class="o">(</span><span class="nc">String</span> <span class="n">title</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">switch</span><span class="o">(</span><span class="n">title</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">case</span> <span class="s">"1"</span><span class="o">:</span>
        <span class="k">case</span> <span class="s">"0"</span><span class="o">:</span>
            <span class="n">storeDigit</span><span class="o">(</span><span class="n">title</span><span class="o">);</span>
            <span class="k">break</span><span class="o">;</span>
        <span class="k">case</span> <span class="s">"plus"</span><span class="o">:</span>
        <span class="k">case</span> <span class="s">"minus"</span><span class="o">:</span>
            <span class="n">storeOperator</span><span class="o">(</span><span class="n">title</span><span class="o">);</span>
            <span class="k">break</span><span class="o">;</span>
        <span class="k">case</span> <span class="s">"="</span><span class="o">:</span>
            <span class="n">showResult</span><span class="o">();</span>
            <span class="k">break</span><span class="o">;</span>
        <span class="k">case</span> <span class="s">"display"</span><span class="o">:</span>
            <span class="n">reset</span><span class="o">();</span>
            <span class="k">break</span><span class="o">;</span>
        <span class="k">default</span><span class="o">:</span>
            <span class="k">break</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">storeDigit</span><span class="o">(</span><span class="nc">String</span> <span class="n">title</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span><span class="o">(</span> <span class="n">operator</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">)</span> <span class="o">{</span>
            <span class="n">previousNumberText</span> <span class="o">+=</span> <span class="n">title</span><span class="o">;</span>
            <span class="n">display</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">previousNumberText</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="n">currentNumberText</span> <span class="o">+=</span> <span class="n">title</span><span class="o">;</span>
            <span class="n">display</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">currentNumberText</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">storeOperator</span><span class="o">(</span><span class="nc">String</span> <span class="n">title</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span><span class="o">(</span><span class="n">operator</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">)</span> <span class="o">{</span>
            <span class="n">showResult</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="n">operator</span> <span class="o">=</span> <span class="n">title</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">reset</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">previousNumberText</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>
        <span class="n">currentNumberText</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>
        <span class="n">operator</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
        <span class="n">display</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="s">""</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">showResult</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">if</span><span class="o">(!</span><span class="n">isValidStateForResult</span><span class="o">())</span>
            <span class="k">return</span><span class="o">;</span>

        <span class="nc">Integer</span> <span class="n">num1</span> <span class="o">=</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="n">previousNumberText</span><span class="o">,</span> <span class="mi">2</span><span class="o">);</span>
        <span class="nc">Integer</span> <span class="n">num2</span> <span class="o">=</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="n">currentNumberText</span><span class="o">,</span> <span class="mi">2</span><span class="o">);</span>
        <span class="nc">Integer</span> <span class="n">result</span><span class="o">;</span>
        <span class="k">if</span><span class="o">(</span> <span class="n">operator</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="s">"plus"</span><span class="o">))</span> <span class="o">{</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">num1</span> <span class="o">+</span> <span class="n">num2</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">num1</span> <span class="o">+</span> <span class="n">num2</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="n">previousNumberText</span> <span class="o">=</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">toBinaryString</span><span class="o">(</span><span class="n">result</span><span class="o">);</span>
        <span class="n">display</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">previousNumberText</span><span class="o">);</span>
        <span class="n">currentNumberText</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>
        <span class="n">operator</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">boolean</span> <span class="nf">isValidStateForResult</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">if</span><span class="o">(</span><span class="n">previousNumberText</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="n">previousNumberText</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">if</span><span class="o">(</span><span class="n">currentNumberText</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="n">currentNumberText</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">if</span><span class="o">(</span> <span class="n">operator</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">CalculatorTest</span> <span class="o">{</span>
    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">test_calculator</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">Calculator</span> <span class="n">calculator</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Calculator</span><span class="o">();</span>

        <span class="n">calculator</span><span class="o">.</span><span class="na">getZero</span><span class="o">().</span><span class="na">click</span><span class="o">();</span>       <span class="c1">// |-----0-|</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="s">"0"</span><span class="o">,</span> <span class="n">calculator</span><span class="o">.</span><span class="na">getDisplay</span><span class="o">().</span><span class="na">getText</span><span class="o">());</span>

        <span class="n">calculator</span><span class="o">.</span><span class="na">getOne</span><span class="o">().</span><span class="na">click</span><span class="o">();</span>        <span class="c1">// |----01-|</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="s">"01"</span><span class="o">,</span> <span class="n">calculator</span><span class="o">.</span><span class="na">getDisplay</span><span class="o">().</span><span class="na">getText</span><span class="o">());</span>

        <span class="n">calculator</span><span class="o">.</span><span class="na">getPlus</span><span class="o">().</span><span class="na">click</span><span class="o">();</span>       <span class="c1">// |----01-|</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="s">"01"</span><span class="o">,</span> <span class="n">calculator</span><span class="o">.</span><span class="na">getDisplay</span><span class="o">().</span><span class="na">getText</span><span class="o">());</span>

        <span class="n">calculator</span><span class="o">.</span><span class="na">getOne</span><span class="o">().</span><span class="na">click</span><span class="o">();</span>        <span class="c1">// |-----1-|</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="s">"1"</span><span class="o">,</span> <span class="n">calculator</span><span class="o">.</span><span class="na">getDisplay</span><span class="o">().</span><span class="na">getText</span><span class="o">());</span>

        <span class="n">calculator</span><span class="o">.</span><span class="na">getZero</span><span class="o">().</span><span class="na">click</span><span class="o">();</span>       <span class="c1">// |----10-|</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="s">"10"</span><span class="o">,</span> <span class="n">calculator</span><span class="o">.</span><span class="na">getDisplay</span><span class="o">().</span><span class="na">getText</span><span class="o">());</span>

        <span class="n">calculator</span><span class="o">.</span><span class="na">getEqualTo</span><span class="o">().</span><span class="na">click</span><span class="o">();</span>    <span class="c1">// |----11-|</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="s">"11"</span><span class="o">,</span> <span class="n">calculator</span><span class="o">.</span><span class="na">getDisplay</span><span class="o">().</span><span class="na">getText</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ch19-command">Command Pattern</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_gof_definition_18">GoF Definition</h3>
<div class="paragraph">
<p>Encapsulate a request as an object, thereby letting you parameterize clients with different requests, queue or log requests, and support undoable operations.</p>
</div>
<div class="sect3">
<h4 id="_basic_components_13">Basic Components</h4>
<div class="imageblock">
<div class="content">
<img src="images/command-components.png" alt="command components" width="312" height="401">
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Command</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">title</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">Calculator</span> <span class="n">calculator</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Command</span><span class="o">(</span><span class="nc">Calculator</span> <span class="n">calculator</span><span class="o">,</span> <span class="nc">String</span> <span class="n">title</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">calculator</span> <span class="o">=</span> <span class="n">calculator</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">title</span> <span class="o">=</span> <span class="n">title</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">execute</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">calculator</span><span class="o">.</span><span class="na">onClick</span><span class="o">(</span><span class="n">title</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Button</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">title</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">Calculator</span> <span class="n">calculator</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Button</span><span class="o">(</span><span class="nc">Calculator</span> <span class="n">calculator</span><span class="o">,</span> <span class="nc">String</span> <span class="n">title</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">calculator</span> <span class="o">=</span> <span class="n">calculator</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">title</span> <span class="o">=</span> <span class="n">title</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">click</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">calculator</span><span class="o">.</span><span class="na">onCommand</span><span class="o">(</span><span class="n">title</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Display</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">text</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">Calculator</span> <span class="n">calculator</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Display</span><span class="o">(</span><span class="nc">Calculator</span> <span class="n">calculator</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">calculator</span> <span class="o">=</span> <span class="n">calculator</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getText</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">text</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setText</span><span class="o">(</span><span class="nc">String</span> <span class="n">text</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">click</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">calculator</span><span class="o">.</span><span class="na">onCommand</span><span class="o">(</span><span class="s">"display"</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Calculator</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">Display</span> <span class="n">display</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">Button</span> <span class="n">one</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">Button</span> <span class="n">zero</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">Button</span> <span class="n">plus</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">Button</span> <span class="n">minus</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">Button</span> <span class="n">equalTo</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">Button</span> <span class="n">undo</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">Button</span> <span class="n">redo</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">previousNumberText</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">currentNumberText</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">operator</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">Stack</span><span class="o">&lt;</span><span class="nc">Command</span><span class="o">&gt;</span> <span class="n">undoStack</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Stack</span><span class="o">&lt;&gt;();</span>
    <span class="kd">private</span> <span class="nc">Stack</span><span class="o">&lt;</span><span class="nc">Command</span><span class="o">&gt;</span> <span class="n">redoStack</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Stack</span><span class="o">&lt;&gt;();</span>

    <span class="kd">public</span> <span class="nf">Calculator</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">display</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Display</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
        <span class="n">one</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Button</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="s">"1"</span><span class="o">);</span>
        <span class="n">zero</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Button</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="s">"0"</span><span class="o">);</span>
        <span class="n">plus</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Button</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="s">"plus"</span><span class="o">);</span>
        <span class="n">minus</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Button</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="s">"minus"</span><span class="o">);</span>
        <span class="n">equalTo</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Button</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="s">"="</span><span class="o">);</span>
        <span class="n">undo</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Button</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="s">"undo"</span><span class="o">);</span>
        <span class="n">redo</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Button</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="s">"redo"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">Button</span> <span class="nf">getOne</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">one</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">Button</span> <span class="nf">getZero</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">zero</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">Button</span> <span class="nf">getPlus</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">plus</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">Button</span> <span class="nf">getMinus</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">minus</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">Button</span> <span class="nf">getEqualTo</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">equalTo</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">Button</span> <span class="nf">getUndo</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">undo</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">Button</span> <span class="nf">getRedo</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">redo</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">Display</span> <span class="nf">getDisplay</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">display</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onCommand</span><span class="o">(</span><span class="nc">String</span> <span class="n">title</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">switch</span><span class="o">(</span><span class="n">title</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">case</span> <span class="s">"undo"</span><span class="o">:</span>
                <span class="n">undo</span><span class="o">();</span>
                <span class="k">break</span><span class="o">;</span>
            <span class="k">case</span> <span class="s">"redo"</span><span class="o">:</span>
                <span class="n">redo</span><span class="o">();</span>
                <span class="k">break</span><span class="o">;</span>
            <span class="k">default</span><span class="o">:</span>
                <span class="n">addCommand</span><span class="o">(</span><span class="n">title</span><span class="o">);</span>
                <span class="n">onClick</span><span class="o">(</span><span class="n">title</span><span class="o">);</span>
                <span class="k">break</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onClick</span><span class="o">(</span><span class="nc">String</span> <span class="n">title</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">switch</span><span class="o">(</span><span class="n">title</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">case</span> <span class="s">"1"</span><span class="o">:</span>
        <span class="k">case</span> <span class="s">"0"</span><span class="o">:</span>
            <span class="n">storeDigit</span><span class="o">(</span><span class="n">title</span><span class="o">);</span>
            <span class="k">break</span><span class="o">;</span>
        <span class="k">case</span> <span class="s">"plus"</span><span class="o">:</span>
        <span class="k">case</span> <span class="s">"minus"</span><span class="o">:</span>
            <span class="n">storeOperator</span><span class="o">(</span><span class="n">title</span><span class="o">);</span>
            <span class="k">break</span><span class="o">;</span>
        <span class="k">case</span> <span class="s">"="</span><span class="o">:</span>
            <span class="n">showResult</span><span class="o">();</span>
            <span class="k">break</span><span class="o">;</span>
        <span class="k">case</span> <span class="s">"display"</span><span class="o">:</span>
            <span class="n">reset</span><span class="o">();</span>
            <span class="k">break</span><span class="o">;</span>
        <span class="k">default</span><span class="o">:</span>
            <span class="k">break</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">addCommand</span><span class="o">(</span><span class="nc">String</span> <span class="n">title</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">undoStack</span><span class="o">.</span><span class="na">push</span><span class="o">(</span><span class="k">new</span> <span class="nc">Command</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="n">title</span><span class="o">));</span>
        <span class="n">redoStack</span><span class="o">.</span><span class="na">clear</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">undo</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">if</span><span class="o">(</span> <span class="o">!</span><span class="n">undoStack</span><span class="o">.</span><span class="na">empty</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">redoStack</span><span class="o">.</span><span class="na">push</span><span class="o">(</span><span class="n">undoStack</span><span class="o">.</span><span class="na">pop</span><span class="o">());</span>
            <span class="n">replay</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">redo</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">if</span><span class="o">(</span> <span class="o">!</span><span class="n">redoStack</span><span class="o">.</span><span class="na">empty</span><span class="o">())</span> <span class="o">{</span>
            <span class="nc">Command</span> <span class="n">command</span> <span class="o">=</span> <span class="n">redoStack</span><span class="o">.</span><span class="na">pop</span><span class="o">();</span>
            <span class="n">undoStack</span><span class="o">.</span><span class="na">push</span><span class="o">(</span><span class="n">command</span><span class="o">);</span>
            <span class="n">command</span><span class="o">.</span><span class="na">execute</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">replay</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">reset</span><span class="o">();</span>
        <span class="k">if</span><span class="o">(</span> <span class="o">!</span><span class="n">undoStack</span><span class="o">.</span><span class="na">empty</span><span class="o">())</span> <span class="o">{</span>
            <span class="k">for</span><span class="o">(</span><span class="nc">Command</span> <span class="n">command</span> <span class="o">:</span> <span class="n">undoStack</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">command</span><span class="o">.</span><span class="na">execute</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">storeDigit</span><span class="o">(</span><span class="nc">String</span> <span class="n">title</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span><span class="o">(</span> <span class="n">operator</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">)</span> <span class="o">{</span>
            <span class="n">previousNumberText</span> <span class="o">+=</span> <span class="n">title</span><span class="o">;</span>
            <span class="n">display</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">previousNumberText</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="n">currentNumberText</span> <span class="o">+=</span> <span class="n">title</span><span class="o">;</span>
            <span class="n">display</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">currentNumberText</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">storeOperator</span><span class="o">(</span><span class="nc">String</span> <span class="n">title</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span><span class="o">(</span><span class="n">operator</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">)</span> <span class="o">{</span>
            <span class="n">showResult</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="n">operator</span> <span class="o">=</span> <span class="n">title</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">reset</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">previousNumberText</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>
        <span class="n">currentNumberText</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>
        <span class="n">operator</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
        <span class="n">display</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="s">""</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">showResult</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">if</span><span class="o">(!</span><span class="n">isValidStateForResult</span><span class="o">())</span>
            <span class="k">return</span><span class="o">;</span>

        <span class="nc">Integer</span> <span class="n">num1</span> <span class="o">=</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="n">previousNumberText</span><span class="o">,</span> <span class="mi">2</span><span class="o">);</span>
        <span class="nc">Integer</span> <span class="n">num2</span> <span class="o">=</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="n">currentNumberText</span><span class="o">,</span> <span class="mi">2</span><span class="o">);</span>
        <span class="nc">Integer</span> <span class="n">result</span><span class="o">;</span>
        <span class="k">if</span><span class="o">(</span> <span class="n">operator</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="s">"plus"</span><span class="o">))</span> <span class="o">{</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">num1</span> <span class="o">+</span> <span class="n">num2</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">num1</span> <span class="o">+</span> <span class="n">num2</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="n">previousNumberText</span> <span class="o">=</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">toBinaryString</span><span class="o">(</span><span class="n">result</span><span class="o">);</span>
        <span class="n">display</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">previousNumberText</span><span class="o">);</span>
        <span class="n">currentNumberText</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>
        <span class="n">operator</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">boolean</span> <span class="nf">isValidStateForResult</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">if</span><span class="o">(</span><span class="n">previousNumberText</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="n">previousNumberText</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">if</span><span class="o">(</span><span class="n">currentNumberText</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="n">currentNumberText</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">if</span><span class="o">(</span> <span class="n">operator</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">CalculatorTest</span> <span class="o">{</span>
    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">test_calculator</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">Calculator</span> <span class="n">calculator</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Calculator</span><span class="o">();</span>

        <span class="n">calculator</span><span class="o">.</span><span class="na">getOne</span><span class="o">().</span><span class="na">click</span><span class="o">();</span>         <span class="c1">// |-----1-|</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="s">"1"</span><span class="o">,</span> <span class="n">calculator</span><span class="o">.</span><span class="na">getDisplay</span><span class="o">().</span><span class="na">getText</span><span class="o">());</span>

        <span class="n">calculator</span><span class="o">.</span><span class="na">getZero</span><span class="o">().</span><span class="na">click</span><span class="o">();</span>        <span class="c1">// |----10-|</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="s">"10"</span><span class="o">,</span> <span class="n">calculator</span><span class="o">.</span><span class="na">getDisplay</span><span class="o">().</span><span class="na">getText</span><span class="o">());</span>

        <span class="n">calculator</span><span class="o">.</span><span class="na">getUndo</span><span class="o">().</span><span class="na">click</span><span class="o">();</span>        <span class="c1">// |-----1-|</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="s">"1"</span><span class="o">,</span> <span class="n">calculator</span><span class="o">.</span><span class="na">getDisplay</span><span class="o">().</span><span class="na">getText</span><span class="o">());</span>

        <span class="n">calculator</span><span class="o">.</span><span class="na">getRedo</span><span class="o">().</span><span class="na">click</span><span class="o">();</span>        <span class="c1">// |----10-|</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="s">"10"</span><span class="o">,</span> <span class="n">calculator</span><span class="o">.</span><span class="na">getDisplay</span><span class="o">().</span><span class="na">getText</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ch20-chain">Chain of Responsibility Pattern</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_gof_definition_19">GoF Definition</h3>
<div class="paragraph">
<p>Avoid coupling the sender of a request to its receiver by giving more than one object a chance to handle the request. Chain the receiving objects and pass the request along the chain until an object handles it.</p>
</div>
<div class="sect3">
<h4 id="_basic_components_14">Basic Components</h4>
<div class="imageblock">
<div class="content">
<img src="images/chain-components.png" alt="chain components" width="473" height="185">
</div>
</div>
</div>
<div class="sect3">
<h4 id="_uml_representation_18">UML Representation</h4>
<div class="imageblock">
<div class="content">
<img src="images/authenticator-components.png" alt="authenticator components" width="965" height="417">
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Request</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">username</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">password</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getUsername</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">username</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setUsername</span><span class="o">(</span><span class="nc">String</span> <span class="n">username</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">username</span> <span class="o">=</span> <span class="n">username</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getPassword</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">password</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setPassword</span><span class="o">(</span><span class="nc">String</span> <span class="n">password</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">password</span> <span class="o">=</span> <span class="n">password</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Response</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">result</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">message</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getResult</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setResult</span><span class="o">(</span><span class="nc">String</span> <span class="n">result</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getMessage</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">message</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setMessage</span><span class="o">(</span><span class="nc">String</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">message</span> <span class="o">=</span> <span class="n">message</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">IAuthenticator</span> <span class="o">{</span>
    <span class="nc">IAuthenticator</span> <span class="nf">setNext</span><span class="o">(</span><span class="nc">IAuthenticator</span> <span class="n">authenticator</span><span class="o">);</span>
    <span class="nc">Response</span> <span class="nf">authenticate</span><span class="o">(</span><span class="nc">Request</span> <span class="n">request</span><span class="o">);</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">AbstractAuthenticator</span> <span class="kd">implements</span> <span class="nc">IAuthenticator</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">IAuthenticator</span> <span class="n">nextAuthenticator</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nc">IAuthenticator</span> <span class="nf">setNext</span><span class="o">(</span><span class="nc">IAuthenticator</span> <span class="n">authenticator</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">nextAuthenticator</span> <span class="o">=</span> <span class="n">authenticator</span><span class="o">;</span>
        <span class="k">return</span> <span class="n">authenticator</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">Response</span> <span class="nf">authenticate</span><span class="o">(</span><span class="nc">Request</span> <span class="n">request</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span><span class="o">(</span> <span class="n">nextAuthenticator</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">nextAuthenticator</span><span class="o">.</span><span class="na">authenticate</span><span class="o">(</span><span class="n">request</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">CustomerAuthenticator</span> <span class="kd">extends</span> <span class="nc">AbstractAuthenticator</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="nc">String</span><span class="o">[]</span> <span class="n">customerList</span> <span class="o">=</span> <span class="o">{</span>
        <span class="s">"customer1@gmail.com"</span><span class="o">,</span>
        <span class="s">"customer2@rediffmain.com"</span>
    <span class="o">};</span>

    <span class="kd">public</span> <span class="nc">Response</span> <span class="nf">authenticate</span><span class="o">(</span><span class="nc">Request</span> <span class="n">request</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">for</span><span class="o">(</span><span class="nc">String</span> <span class="n">customer</span> <span class="o">:</span> <span class="n">customerList</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">if</span><span class="o">(</span><span class="n">customer</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">request</span><span class="o">.</span><span class="na">getUsername</span><span class="o">()))</span> <span class="o">{</span>
                <span class="nc">Response</span> <span class="n">response</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Response</span><span class="o">();</span>
                <span class="n">response</span><span class="o">.</span><span class="na">setResult</span><span class="o">(</span><span class="s">"SUCCESS"</span><span class="o">);</span>
                <span class="n">response</span><span class="o">.</span><span class="na">setMessage</span><span class="o">(</span><span class="s">"Customer Login Successful."</span><span class="o">);</span>
                <span class="k">return</span> <span class="n">response</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span>

        <span class="k">return</span> <span class="kd">super</span><span class="o">.</span><span class="na">authenticate</span><span class="o">(</span><span class="n">request</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">EmployeeAuthenticator</span> <span class="kd">extends</span> <span class="nc">AbstractAuthenticator</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="nc">String</span><span class="o">[]</span> <span class="n">employeeList</span> <span class="o">=</span> <span class="o">{</span>
        <span class="s">"employee1@company.com"</span><span class="o">,</span>
        <span class="s">"employee2@company.com"</span>
    <span class="o">};</span>

    <span class="kd">public</span> <span class="nc">Response</span> <span class="nf">authenticate</span><span class="o">(</span><span class="nc">Request</span> <span class="n">request</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">for</span><span class="o">(</span><span class="nc">String</span> <span class="n">enployee</span> <span class="o">:</span> <span class="n">employeeList</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">if</span><span class="o">(</span><span class="n">enployee</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">request</span><span class="o">.</span><span class="na">getUsername</span><span class="o">()))</span> <span class="o">{</span>
                <span class="nc">Response</span> <span class="n">response</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Response</span><span class="o">();</span>
                <span class="n">response</span><span class="o">.</span><span class="na">setResult</span><span class="o">(</span><span class="s">"SUCCESS"</span><span class="o">);</span>
                <span class="n">response</span><span class="o">.</span><span class="na">setMessage</span><span class="o">(</span><span class="s">"Employee Login Successful."</span><span class="o">);</span>
                <span class="k">return</span> <span class="n">response</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span>

        <span class="k">return</span> <span class="kd">super</span><span class="o">.</span><span class="na">authenticate</span><span class="o">(</span><span class="n">request</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">NoUserAuthenticator</span> <span class="kd">extends</span> <span class="nc">AbstractAuthenticator</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nc">Response</span> <span class="nf">authenticate</span><span class="o">(</span><span class="nc">Request</span> <span class="n">request</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Response</span> <span class="n">response</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Response</span><span class="o">();</span>
        <span class="n">response</span><span class="o">.</span><span class="na">setResult</span><span class="o">(</span><span class="s">"FAILURE"</span><span class="o">);</span>
        <span class="n">response</span><span class="o">.</span><span class="na">setMessage</span><span class="o">(</span><span class="s">"No User Found."</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">response</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">LoginService</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">IAuthenticator</span> <span class="n">authenticator</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">LoginService</span><span class="o">(</span><span class="nc">IAuthenticator</span> <span class="n">authenticator</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">authenticator</span> <span class="o">=</span> <span class="n">authenticator</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="nc">Response</span> <span class="nf">login</span><span class="o">(</span><span class="nc">String</span> <span class="n">username</span><span class="o">,</span> <span class="nc">String</span> <span class="n">password</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Request</span> <span class="n">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Request</span><span class="o">();</span>
        <span class="n">request</span><span class="o">.</span><span class="na">setUsername</span><span class="o">(</span><span class="n">username</span><span class="o">);</span>
        <span class="n">request</span><span class="o">.</span><span class="na">setPassword</span><span class="o">(</span><span class="n">password</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">authenticator</span><span class="o">.</span><span class="na">authenticate</span><span class="o">(</span><span class="n">request</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">LoginServiceTest</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="nc">LoginService</span> <span class="n">target</span><span class="o">;</span>

    <span class="nd">@BeforeEach</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">beforeEach</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">IAuthenticator</span> <span class="n">authenticator</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">EmployeeAuthenticator</span><span class="o">();</span>
        <span class="n">authenticator</span>
            <span class="o">.</span><span class="na">setNext</span><span class="o">(</span><span class="k">new</span> <span class="nc">CustomerAuthenticator</span><span class="o">())</span>
            <span class="o">.</span><span class="na">setNext</span><span class="o">(</span><span class="k">new</span> <span class="nc">NoUserAuthenticator</span><span class="o">());</span>
        <span class="n">target</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">LoginService</span><span class="o">(</span><span class="n">authenticator</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">test_login_customer</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">Response</span> <span class="n">response</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="na">login</span><span class="o">(</span><span class="s">"customer1@gmail.com"</span><span class="o">,</span> <span class="s">"password"</span><span class="o">);</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="s">"SUCCESS"</span><span class="o">,</span> <span class="n">response</span><span class="o">.</span><span class="na">getResult</span><span class="o">());</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="s">"Customer Login Successful."</span><span class="o">,</span> <span class="n">response</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">test_login_employee</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">Response</span> <span class="n">response</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="na">login</span><span class="o">(</span><span class="s">"employee1@company.com"</span><span class="o">,</span> <span class="s">"password"</span><span class="o">);</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="s">"SUCCESS"</span><span class="o">,</span> <span class="n">response</span><span class="o">.</span><span class="na">getResult</span><span class="o">());</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="s">"Employee Login Successful."</span><span class="o">,</span> <span class="n">response</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">test_login_unknown</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">Response</span> <span class="n">response</span> <span class="o">=</span> <span class="n">target</span><span class="o">.</span><span class="na">login</span><span class="o">(</span><span class="s">"somebody@company.com"</span><span class="o">,</span> <span class="s">"password"</span><span class="o">);</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="s">"FAILURE"</span><span class="o">,</span> <span class="n">response</span><span class="o">.</span><span class="na">getResult</span><span class="o">());</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="s">"No User Found."</span><span class="o">,</span> <span class="n">response</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ch21-state">State Pattern</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_gof_definition_20">GoF Definition</h3>
<div class="paragraph">
<p>Allow an object to alter its behavior when its internal state changes. The object will appear to change its class.</p>
</div>
<div class="sect3">
<h4 id="_basic_components_15">Basic Components</h4>
<div class="imageblock">
<div class="content">
<img src="images/stats-components.png" alt="stats components" width="454" height="218">
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ch22-strategy">Strategy Pattern</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_gof_definition_21">GoF Definition</h3>
<div class="paragraph">
<p>Define a family of algorithms, encapsulate each one, and make them interchange- able. Strategy lets the algorithm vary independently from clients that use it.</p>
</div>
<div class="sect3">
<h4 id="_basic_components_16">Basic Components</h4>
<div class="imageblock">
<div class="content">
<img src="images/strategy-components.png" alt="strategy components" width="500" height="202">
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ch17-template">Template Method Pattern</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_gof_definition_22">GoF Definition</h3>
<div class="paragraph">
<p>Define the skeleton of an algorithm in an operation, deferring some steps to subclasses. Template Method lets subclasses redefine certain steps of an algorithm without changing the algorithm&#8217;s structure.</p>
</div>
<div class="sect3">
<h4 id="_basic_components_17">Basic Components</h4>
<div class="imageblock">
<div class="content">
<img src="images/template-components.png" alt="template components" width="371" height="250">
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ch24-visitor">Visitor Pattern</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_gof_definition_23">GoF Definition</h3>
<div class="paragraph">
<p>Represent an operation to be performed on the elements of an object structure.Vis- itor lets you define a new operation without changing the classes of the elements on which it operates.</p>
</div>
<div class="sect3">
<h4 id="_basic_components_18">Basic Components</h4>
<div class="imageblock">
<div class="content">
<img src="images/visitor-components.png" alt="visitor components" width="724" height="441">
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">AbstractVisitor</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">visitHTMLElement</span><span class="o">(</span><span class="nc">HTMLElement</span> <span class="n">element</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// empty method</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">visitBodyElement</span><span class="o">(</span><span class="nc">BodyElement</span> <span class="n">element</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// empty method</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">visitPElement</span><span class="o">(</span><span class="nc">PElement</span> <span class="n">element</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// empty method</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">visitTextElement</span><span class="o">(</span><span class="nc">TextElement</span> <span class="n">element</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// empty method</span>
    <span class="o">}</span>

<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">HTMLElement</span> <span class="o">{</span>
    <span class="kd">protected</span> <span class="nc">String</span> <span class="n">tagName</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">HTMLElement</span><span class="o">&gt;</span> <span class="n">children</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;();</span>

    <span class="kd">public</span> <span class="nf">HTMLElement</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">(</span><span class="s">"html"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">visitChildren</span><span class="o">(</span><span class="nc">AbstractVisitor</span> <span class="n">visitor</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">for</span><span class="o">(</span><span class="nc">HTMLElement</span> <span class="n">element</span> <span class="o">:</span> <span class="n">children</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">element</span><span class="o">.</span><span class="na">accept</span><span class="o">(</span><span class="n">visitor</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">accept</span><span class="o">(</span><span class="nc">AbstractVisitor</span> <span class="n">visitor</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">visitChildren</span><span class="o">(</span><span class="n">visitor</span><span class="o">);</span>
        <span class="n">visitor</span><span class="o">.</span><span class="na">visitHTMLElement</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nf">HTMLElement</span><span class="o">(</span><span class="nc">String</span> <span class="n">tagName</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">tagName</span> <span class="o">=</span> <span class="n">tagName</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">add</span><span class="o">(</span><span class="nc">HTMLElement</span> <span class="n">element</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">children</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">element</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">StringBuilder</span> <span class="n">builder</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">StringBuilder</span><span class="o">();</span>
        <span class="n">builder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">"&lt;"</span><span class="o">);</span>
        <span class="n">builder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">tagName</span><span class="o">);</span>
        <span class="n">builder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">"&gt;"</span><span class="o">);</span>
        <span class="k">for</span><span class="o">(</span><span class="nc">HTMLElement</span> <span class="n">element</span> <span class="o">:</span> <span class="n">children</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">builder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">element</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
        <span class="o">}</span>
        <span class="n">builder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">"&lt;/"</span><span class="o">);</span>
        <span class="n">builder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">tagName</span><span class="o">);</span>
        <span class="n">builder</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">"&gt;"</span><span class="o">);</span>

        <span class="k">return</span> <span class="n">builder</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">BodyElement</span> <span class="kd">extends</span> <span class="nc">HTMLElement</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">BodyElement</span><span class="o">()</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">(</span><span class="s">"body"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">accept</span><span class="o">(</span><span class="nc">AbstractVisitor</span> <span class="n">visitor</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">visitChildren</span><span class="o">(</span><span class="n">visitor</span><span class="o">);</span>
        <span class="n">visitor</span><span class="o">.</span><span class="na">visitBodyElement</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">PElement</span> <span class="kd">extends</span> <span class="nc">HTMLElement</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">PElement</span><span class="o">()</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">(</span><span class="s">"p"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">accept</span><span class="o">(</span><span class="nc">AbstractVisitor</span> <span class="n">visitor</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">visitChildren</span><span class="o">(</span><span class="n">visitor</span><span class="o">);</span>
        <span class="n">visitor</span><span class="o">.</span><span class="na">visitPElement</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">TextElement</span> <span class="kd">extends</span> <span class="nc">HTMLElement</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">TextElement</span><span class="o">(</span><span class="nc">String</span> <span class="n">text</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">(</span><span class="n">text</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getText</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">tagName</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setText</span><span class="o">(</span><span class="nc">String</span> <span class="n">text</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">tagName</span> <span class="o">=</span> <span class="n">text</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">tagName</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">accept</span><span class="o">(</span><span class="nc">AbstractVisitor</span> <span class="n">visitor</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">visitor</span><span class="o">.</span><span class="na">visitTextElement</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Markup</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nc">HTMLElement</span> <span class="nf">createMarkup</span><span class="o">(</span><span class="nc">String</span> <span class="n">text</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">HTMLElement</span> <span class="n">html</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HTMLElement</span><span class="o">();</span>
        <span class="nc">BodyElement</span> <span class="n">body</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BodyElement</span><span class="o">();</span>
        <span class="nc">PElement</span> <span class="n">p</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">PElement</span><span class="o">();</span>
        <span class="nc">TextElement</span> <span class="n">textElement</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">TextElement</span><span class="o">(</span><span class="n">text</span><span class="o">);</span>
        <span class="n">html</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">body</span><span class="o">);</span>
        <span class="n">body</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">p</span><span class="o">);</span>
        <span class="n">p</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">textElement</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">html</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">BasicVisitor</span> <span class="kd">extends</span> <span class="nc">AbstractVisitor</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">visitedList</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;();</span>

    <span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">getList</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">visitedList</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">visitHTMLElement</span><span class="o">(</span><span class="nc">HTMLElement</span> <span class="n">element</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">visitedList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"Visited HTML: "</span> <span class="o">+</span> <span class="n">element</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
        <span class="n">visitedList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"\n--\n"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">visitBodyElement</span><span class="o">(</span><span class="nc">BodyElement</span> <span class="n">element</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">visitedList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"Visited Body: "</span> <span class="o">+</span> <span class="n">element</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
        <span class="n">visitedList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"\n--\n"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">visitPElement</span><span class="o">(</span><span class="nc">PElement</span> <span class="n">element</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">visitedList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"Visited P: "</span> <span class="o">+</span> <span class="n">element</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
        <span class="n">visitedList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"\n--\n"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">visitTextElement</span><span class="o">(</span><span class="nc">TextElement</span> <span class="n">element</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">visitedList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"Visited Text: "</span> <span class="o">+</span> <span class="n">element</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
        <span class="n">visitedList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"\n--\n"</span><span class="o">);</span>
    <span class="o">}</span>

<span class="o">}</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="java"><span class="kd">class</span> <span class="nc">VisitorTest</span> <span class="o">{</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">test_markup_visitor</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">Markup</span> <span class="n">markup</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Markup</span><span class="o">();</span>
        <span class="nc">HTMLElement</span> <span class="n">rootElement</span> <span class="o">=</span> <span class="n">markup</span><span class="o">.</span><span class="na">createMarkup</span><span class="o">(</span><span class="s">"Hello World!"</span><span class="o">);</span>

        <span class="nc">BasicVisitor</span> <span class="n">visitor</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BasicVisitor</span><span class="o">();</span>
        <span class="n">rootElement</span><span class="o">.</span><span class="na">accept</span><span class="o">(</span><span class="n">visitor</span><span class="o">);</span>

        <span class="nc">String</span><span class="o">[]</span> <span class="n">expectedValues</span> <span class="o">=</span> <span class="o">{</span>
            <span class="s">"Visited Text: Hello World!"</span><span class="o">,</span>
            <span class="s">"\n--\n"</span><span class="o">,</span>
            <span class="s">"Visited P: &lt;p&gt;Hello World!&lt;/p&gt;"</span><span class="o">,</span>
            <span class="s">"\n--\n"</span><span class="o">,</span>
            <span class="s">"Visited Body: &lt;body&gt;&lt;p&gt;Hello World!&lt;/p&gt;&lt;/body&gt;"</span><span class="o">,</span>
            <span class="s">"\n--\n"</span><span class="o">,</span>
            <span class="s">"Visited HTML: &lt;html&gt;&lt;body&gt;&lt;p&gt;Hello World!&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;"</span><span class="o">,</span>
            <span class="s">"\n--\n"</span>
        <span class="o">};</span>

        <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="n">visitor</span><span class="o">.</span><span class="na">getList</span><span class="o">().</span><span class="na">size</span><span class="o">();</span> <span class="n">index</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">assertEquals</span><span class="o">(</span><span class="n">expectedValues</span><span class="o">[</span><span class="n">index</span><span class="o">],</span> <span class="n">visitor</span><span class="o">.</span><span class="na">getList</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="n">index</span><span class="o">));</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">test_markup_textenhancervisitor</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">Markup</span> <span class="n">markup</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Markup</span><span class="o">();</span>
        <span class="nc">HTMLElement</span> <span class="n">rootElement</span> <span class="o">=</span> <span class="n">markup</span><span class="o">.</span><span class="na">createMarkup</span><span class="o">(</span><span class="s">"Hello World!"</span><span class="o">);</span>

        <span class="nc">BasicVisitor</span> <span class="n">visitor</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BasicVisitor</span><span class="o">();</span>
        <span class="nc">TextEnhancerVisitor</span> <span class="n">textEnhancerVisitor</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">TextEnhancerVisitor</span><span class="o">();</span>
        <span class="n">rootElement</span><span class="o">.</span><span class="na">accept</span><span class="o">(</span><span class="n">textEnhancerVisitor</span><span class="o">);</span>
        <span class="n">rootElement</span><span class="o">.</span><span class="na">accept</span><span class="o">(</span><span class="n">visitor</span><span class="o">);</span>

        <span class="nc">String</span><span class="o">[]</span> <span class="n">expectedValues</span> <span class="o">=</span> <span class="o">{</span>
            <span class="s">"Visited Text: Hello World!(New)"</span><span class="o">,</span>
            <span class="s">"\n--\n"</span><span class="o">,</span>
            <span class="s">"Visited P: &lt;p&gt;Hello World!(New)&lt;/p&gt;"</span><span class="o">,</span>
            <span class="s">"\n--\n"</span><span class="o">,</span>
            <span class="s">"Visited Body: &lt;body&gt;&lt;p&gt;Hello World!(New)&lt;/p&gt;&lt;/body&gt;"</span><span class="o">,</span>
            <span class="s">"\n--\n"</span><span class="o">,</span>
            <span class="s">"Visited HTML: &lt;html&gt;&lt;body&gt;&lt;p&gt;Hello World!(New)&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;"</span><span class="o">,</span>
            <span class="s">"\n--\n"</span>
        <span class="o">};</span>

        <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="n">visitor</span><span class="o">.</span><span class="na">getList</span><span class="o">().</span><span class="na">size</span><span class="o">();</span> <span class="n">index</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">assertEquals</span><span class="o">(</span><span class="n">expectedValues</span><span class="o">[</span><span class="n">index</span><span class="o">],</span> <span class="n">visitor</span><span class="o">.</span><span class="na">getList</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="n">index</span><span class="o">));</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_example_conventions">Example Conventions</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/mvonballmo/CSharpHandbook">CSharpHandbook on Github by Marco van Ballmoose</a></p>
</li>
<li>
<p><a href="https://docs.microsoft.com/en-us/dotnet/standard/design-guidelines/">Microsoft Framework Design Guidelines</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_references">References</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Abran, Alain, editor. Guide to the Software Engineering Body of Knowledge, 2004 Version: SWEBOK ; a Project of the IEEE Computer Society Professional Practices Committee. IEEE Computer Society, 2004.</p>
</li>
<li>
<p>Freeman, Eric, et al., editors. Head First Design Patterns. O’Reilly, 2004.</p>
</li>
<li>
<p>Gamma, Erich, editor. Design Patterns: Elements of Reusable Object-Oriented Software. Addison-Wesley, 1995.</p>
</li>
<li>
<p>Sarcar, Vaskaran. Java Design Patterns: A Tour of 23 Gang of Four Design Patterns in Java. Apress, 2016.</p>
</li>
<li>
<p>Timms, Simon. Mastering Javascript Design Patterns. Packt Publishing, 2014.</p>
</li>
<li>
<p>Martin, Robert C., editor. Clean Code: A Handbook of Agile Software Craftsmanship. Prentice Hall, 2009.</p>
</li>
<li>
<p>Hall, Gary McLean. Adaptive Code: Agile Coding with Design Patterns and SOLID Principles. Second edition, Microsoft Press, 2017.</p>
</li>
<li>
<p>Evans, Eric. Domain-Driven Design: Tackling Complexity in the Heart of Software. Addison-Wesley, 2004.</p>
</li>
<li>
<p>Leitner, Helmut. Pattern Theory: Introduction and Perspectives on the Tracks of Christopher Alexander. First printing, Helmut Leitner, HLS Software, 2015.</p>
</li>
<li>
<p>Thomas, David, and Andrew Hunt. The Pragmatic Programmer, 20th Anniversary Edition: Journey to Mastery. Second edition, Addison-Wesley, 2019.</p>
</li>
<li>
<p>Kerievsky, Joshua. Refactoring to Patterns. 5 print, Addison-Wesley, 2007.</p>
</li>
<li>
<p>Thomas, David, and Andrew Hunt. The Pragmatic Programmer, 20th Anniversary Edition: Journey to Mastery. Second edition, Addison-Wesley, 2019.</p>
</li>
<li>
<p><a href="http://ftacademy.org/sites/ftacademy.org/files/materials/fta-m11-soft_arch-pre.pdf">Software Architecture Guide by Free Technology Academy</a></p>
</li>
<li>
<p><a href="https://martinfowler.com/eaaCatalog/">Martin Fowler&#8217;s Catalog of Patterns of Enterprise Application Architecture</a></p>
</li>
<li>
<p><a href="http://coding-geek.com/category/design-pattern/">Coding Geek</a> Design Pattern category posts</p>
</li>
<li>
<p><a href="https://refactoring.guru/design-patterns/abstract-factory/java/example">Refactoring Guru</a> Design Patterns Catalog</p>
</li>
<li>
<p><a href="https://martinfowler.com/articles/writingPatterns.html">Martin Fowlers Article on Patterns</a></p>
</li>
<li>
<p><a href="https://hillside.net/index.php/a-pattern-language-for-pattern-writing">A Pattern Language for Pattern Writing</a> by Gerard Meszaros, Jim Doble</p>
</li>
<li>
<p><a href="https://stackabuse.com/tag/design-patterns/">Design Pattern tag articles on StackAbuse.com site</a> <a href="https://stackabuse.com/structural-design-patterns-in-java/">Structural</a> <a href="https://stackabuse.com/behavioral-design-patterns-in-java/">Behavioral</a> <a href="https://stackabuse.com/design-patterns-in-java/">Catalog</a></p>
</li>
<li>
<p><a href="https://stackoverflow.com/questions/1673841/examples-of-gof-design-patterns-in-javas-core-libraries/">Examples from JDK community post on StackOverflow.com</a></p>
</li>
<li>
<p><a href="https://iknown.blogspot.com/2003/08/design-patterns.html">Popular mnemonic for Design Patterns</a> from <a href="https://www.linkedin.com/in/amungale/">Ajit Mungale</a> from 2003</p>
</li>
<li>
<p><a href="https://jeffreykegler.github.io/Ocean-of-Awareness-blog/individual/2013/03/interpreter.html">About Interpreter Pattern and its difficult nature.</a></p>
</li>
<li>
<p><a href="http://www.mcdonaldland.info/files/designpatterns/designpatternscard.pdf">Design Patterns Cheatsheet</a> by <a href="http://www.McDonaldLand.info">Jason S. McDonald</a></p>
</li>
<li>
<p><a href="https://www.oodesign.com/">Design pattern examples at OODesign.com</a></p>
</li>
<li>
<p><a href="https://holub.com/goodies/holub_design_patterns.pdf">Allen Holub Design Patterns Reference PDF</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="A-mnemonic">Appendix A: Mnemonic to remember design patterns</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Some details here</p>
</div>
<div class="sect2">
<h3 id="_popular_mnemonic_from_ajit_mungales_article">Popular Mnemonic from Ajit Mungale&#8217;s article</h3>
<div class="paragraph">
<p>Interesting mnemonic for the design patterns is available on internet from a post in 2003.  I was able to find reference to thisarticle from 2003 and then it is copied and published in many articles.  The real origin of this mnemonic is unknown.</p>
</div>
<div class="sect3">
<h4 id="_creational_patterns">Creational Patterns</h4>
<div class="ulist">
<ul>
<li>
<p>Abstract Factory: Creates an instance of several families of classes</p>
</li>
<li>
<p>Builder: Separates object construction from its representation</p>
</li>
<li>
<p>Factory Method: Creates an instance of several derived classes</p>
</li>
<li>
<p>Prototype: A fully initialized instance to be copied or cloned</p>
</li>
<li>
<p>Singleton: A class in which only a single instance can exist</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Mnemonic: ABFPS (Abraham Became First President of States). </p>
</div>
</div>
<div class="sect3">
<h4 id="_structural_patterns">Structural Patterns</h4>
<div class="ulist">
<ul>
<li>
<p>Adapter: Match interfaces of different classes</p>
</li>
<li>
<p>Bridge: Separates an object’s abstraction from its implementation</p>
</li>
<li>
<p>Composite: A tree structure of simple and composite objects</p>
</li>
<li>
<p>Decorator: Add responsibilities to objects dynamically</p>
</li>
<li>
<p>Façade: A single class that represents an entire subsystem</p>
</li>
<li>
<p>Flyweight: A fine-grained instance used for efficient sharing</p>
</li>
<li>
<p>Proxy: An object representing another object</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Mnemonic: ABCDFFP </p>
</div>
</div>
<div class="sect3">
<h4 id="_behavioral_patterns">Behavioral Patterns</h4>
<div class="ulist">
<ul>
<li>
<p>Mediator: Defines simplified communication between classes</p>
</li>
<li>
<p>Memento: Capture and restore an object&#8217;s internal state</p>
</li>
<li>
<p>Interpreter: A way to include language elements in a program</p>
</li>
<li>
<p>Iterator: Sequentially access the elements of a collection</p>
</li>
<li>
<p>Chain of Resp: A way of passing a request between a chain of objects</p>
</li>
<li>
<p>Command: Encapsulate a command request as an object</p>
</li>
<li>
<p>State: Alter an object&#8217;s behavior when its state changes</p>
</li>
<li>
<p>Strategy: Encapsulates an algorithm inside a class</p>
</li>
<li>
<p>Observer: A way of notifying change to a number of classes</p>
</li>
<li>
<p>Template Method: Defer the exact steps of an algorithm to a subclass</p>
</li>
<li>
<p>Visitor: Defines a new operation to a class without change</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Mnemonic: 2 MICS On TV (MMIICCSSOTV) </p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="B-ast">Appendix B: Building Abstract Syntax Tree</h2>
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<img src="images/B-ast/exp01.png" alt="exp01.png">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/B-ast/exp02.png" alt="exp02.png">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/B-ast/exp03.png" alt="exp03.png">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/B-ast/exp04.png" alt="exp04.png">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/B-ast/exp05.png" alt="exp05.png">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/B-ast/exp06.png" alt="exp06.png">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/B-ast/exp07.png" alt="exp07.png">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/B-ast/exp08.png" alt="exp08.png">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/B-ast/exp09.png" alt="exp09.png">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/B-ast/exp10.png" alt="exp10.png">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/B-ast/exp11.png" alt="exp11.png">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/B-ast/exp12.png" alt="exp12.png">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/B-ast/exp13.png" alt="exp13.png">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/B-ast/exp14.png" alt="exp14.png">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/B-ast/exp15.png" alt="exp15.png">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/B-ast/exp16.png" alt="exp16.png">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/B-ast/exp17.png" alt="exp17.png">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/B-ast/exp18.png" alt="exp18.png">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/B-ast/exp19.png" alt="exp19.png">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/B-ast/exp20.png" alt="exp20.png">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/B-ast/exp21.png" alt="exp21.png">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/B-ast/exp22.png" alt="exp22.png">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/B-ast/exp23.png" alt="exp23.png">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/B-ast/exp24.png" alt="exp24.png">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/B-ast/exp25.png" alt="exp25.png">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/B-ast/exp26.png" alt="exp26.png">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/B-ast/exp27.png" alt="exp27.png">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/B-ast/exp28.png" alt="exp28.png">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="C-git-repo">Appendix C: Maintaining multiple GIT repositories</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_how_this_repository_is_maintained">How this repository is maintained</h3>
<div class="paragraph">
<p>The GIT repository of this workshop is maintained at 3 servers simulteneously and maintained in all places at the same time.
This is possible due to the flexibility in configuring the repository using GIT.
This section explains how to configure a GIT repository to maintain in in multiple servers at same time</p>
</div>
</div>
<div class="sect2">
<h3 id="_creating_repository_copies">Creating repository copies</h3>
<div class="paragraph">
<p>When the first repository is created then more repositories can be created by creating empty repositories on other servers and adding them as remotes to first repository.
Assuming that the initial repository is at <code>git@github.com:&lt;username&gt;/&lt;projectname&gt;.git</code> (SSH Protocol is assumed here, but can also be done with https protocol) another empty repository should be created on another server.
Here <code>&lt;username&gt;</code> is the user name of the user account on server.
<code>&lt;projectname&gt;</code> is the name of the repository on the server.
Assuming the another repository is at <code>git@gitlab.com:&lt;username&gt;/&lt;projectname&gt;.git</code>.  While creating another repository please choose not to create any README or LICENSE files so the repository will not have any initial commits.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">git remote add gitlab git@gitlab.com:&lt;username&gt;/&lt;projectname&gt;.git <i class="conum" data-value="1"></i><b>(1)</b>
git push gitlab master <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Add the additional server as another remote of the same initial repository</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Push the current version to another server making both repositories same</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_configuring_git_for_simultaneous_push">Configuring GIT for simultaneous push</h3>
<div class="paragraph">
<p>Addition of a new branch named <code>all</code> manually in the <code>.git/config</code> file ensures that we have a branch which can be used to push the commits to all the remote servers at the same time.  Open the config file at <code>.git/config</code> location and add the following section to it at the end</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ini"><span class="nn">[remote "all"]</span>
	<span class="py">url</span> <span class="p">=</span> <span class="s">git@github.com:&lt;username&gt;/&lt;projectname&gt;.git</span>
	<span class="py">url</span> <span class="p">=</span> <span class="s">git@gitlab.com:&lt;username&gt;/&lt;projectname&gt;.git </span><i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>You can keep adding all the remote servers that have been added to the repository here one below the other to ensure push happens to all those servers.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>After this configuration when the user commits and pushes to this branch alias <code>all</code> the push happens for all servers.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">git push all</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command will push the commits to all the servers mentioned in the <code>all</code> branch configuration</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="D-manual-info">Appendix D: How this manual is created</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The content of this manual is written using a framework named <a href="https://asciidoctor.org/">Asciidoctor</a></p>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Asciidoctor is a fast, open source text processor and publishing toolchain for converting AsciiDoc content to HTML5, DocBook, PDF, and other formats. Asciidoctor is written in Ruby and runs on all major operating systems. The Asciidoctor project is hosted on GitHub.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>Asciidoctor reads and parses text written in the AsciiDoc syntax, then feeds the parse tree to a set of built-in converters to produce HTML5, DocBook 5, and man(ual) page output.</p>
</div>
<div class="paragraph">
<p>Using the asciidoctor framework and its plugins the content of this manual source is converted into HTML5, EPUB and PDF document.  The diarams which are written in PlantUML format are converted into images by using asciidoctor-diagram plugin</p>
</div>
<div class="sect2">
<h3 id="_how_to_build_the_manual">How to build the manual</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">./manual/dockerbuild.sh</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footnotes">
<hr>
<div class="footnote" id="_footnotedef_1">
<a href="#_footnoteref_1">1</a>. Pattern from Martin Fowlers Catalog of Patterns of Entreprise Application Architecture
</div>
<div class="footnote" id="_footnotedef_1">
<a href="#_footnoteref_1">1</a>. Christopher Wolfgang Alexander is a British-American architect and design theorist. His theories about the nature of human-centered design have affected fields beyond architecture, including urban design, software, sociology and others. Alexander is regarded as the father of the pattern language movement.
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2025-05-24 10:50:12 UTC
</div>
</div>
</body>
</html>